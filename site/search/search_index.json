{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"install-ubuntu/","title":"{{ $frontmatter.title }}","text":""},{"location":"install-ubuntu/#1-ubuntu","title":"1. ubuntu\u53cc\u7cfb\u7edf","text":"<p>\u70b9\u51fb\u6b64\u5904\u67e5\u770b\u5b89\u88c5\u6559\u7a0b</p> <p>\u521d\u59cb\u4f7f\u7528ubuntu\u7cfb\u7edf\u65f6\uff0c\u4f1a\u9047\u5230\u8f93\u5165\u6cd5\uff0c\u7cfb\u7edf\u5b57\u4f53\u6e32\u67d3\u7b49\u95ee\u9898\uff0c\u4ee5\u4e0b\u662f\u4e00\u4e9b\u53c2\u8003\u8d44\u6599\uff0c\u66f4\u591a\u8d44\u6599\u6b63\u5728\u8865\u5145\u4e2d\u3002</p> <p>\u66f4\u6362\u5b57\u4f53</p> <p>\u5b89\u88c5\u641c\u72d7\u8f93\u5165\u6cd5</p>"},{"location":"install-ubuntu/#2-windowsubuntu","title":"2. windows\u4e0b\u5b89\u88c5ubuntu\u865a\u62df\u673a","text":"<p>\u76ee\u524dCSDN\u548c\u77e5\u4e4e\u6709\u5927\u91cf\u5b89\u88c5ubuntu\u865a\u62df\u673a\u7684\u8d44\u6599\uff0c\u53ef\u4ee5\u8fdb\u884c\u4e00\u4e9b\u53c2\u8003\u3002</p>"},{"location":"pipeline-cpu/","title":"{{ $frontmatter.title }}","text":"<p>::: tip \u6ce8\u610f\u4e8b\u9879\uff1a\u4f7f\u7528\u6700\u65b0\u7684\u9879\u76ee\u4ee3\u7801\u548c\u6587\u6863\uff01 \u9879\u76ee\u4f1a\u6301\u7eed\u4fee\u590d\u4e00\u4e9b\u9519\u8bef\u6216\u589e\u52a0\u4e00\u4e9b\u5bf9\u7528\u6237\u53cb\u597d\u7684\u5185\u5bb9\uff0c\u56e0\u6b64\u9879\u76ee\u548c\u6587\u6863\u4f1a\u6709\u4e0d\u95f4\u65ad\u7684\u66f4\u65b0\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u6700\u65b0\u7684\u9879\u76ee\u548c\u6587\u6863</p> <p>\u5173\u4e8e\u9879\u76ee\uff1a\u5982\u679c\u4f60\u5df2\u7ecf\u514b\u9686\u4e86\u9879\u76ee, \u53ef\u4ee5\u5728\u9879\u76ee\u76ee\u5f55\u4e0b\u4f7f\u7528<code>git pull</code>\u6765\u83b7\u53d6\u6700\u65b0\u7684\u9879\u76ee\u4ee3\u7801\u3002 \u5173\u4e8e\u6587\u6863\uff1a\u6587\u6863\u7684\u6700\u65b0\u7248\u672c\u4f1a\u76f4\u63a5\u5448\u73b0\u5728\u7f51\u9875\u4e0a\uff0c\u53ef\u4ee5\u591a\u7559\u610f\u7f51\u9875\u4e0a\u65b0\u589e\u4e86\u54ea\u4e9b\u5185\u5bb9</p> <p>\u6709\u5173<code>git pull</code>\u547d\u4ee4\u7684\u8be6\u7ec6\u4f7f\u7528\uff0c\u53ef\u4ee5\u901a\u8fc7AI\u6765\u83b7\u5f97\u66f4\u591a\u7684\u4fe1\u606f\u3002</p> <p>:::</p>"},{"location":"pipeline-cpu/#_1","title":"\u4e00\u3001\u9879\u76ee\u4ecb\u7ecd","text":"<p>\u8be5\u9879\u76ee\u662f\u4e00\u4e2aRISC-V\u603b\u63a7\u5f0f\u4e94\u7ea7\u6d41\u6c34\u7ebf\u5904\u7406\u5668\u4eff\u771f\u3001\u6d4b\u8bd5\u6846\u67b6\u3002\u4f60\u53ef\u4ee5\u5c06\u4f60\u7684\u6d41\u6c34\u7ebf\u5904\u7406\u5668\u63a5\u5165\u5230\u8be5\u6846\u67b6\u4e2d\uff0c\u7528\u4e8e\u9a8c\u8bc1\u81ea\u5df1\u7684\u5904\u7406\u5668\u5b9e\u73b0\u662f\u5426\u6b63\u786e\uff0c\u4e5f\u53ef\u4ee5\u5728\u81ea\u5df1\u7684\u5904\u7406\u5668\u4e0a\u8fd0\u884c\u4e00\u4e9b\u7b80\u5355\u7684\u8f6f\u4ef6\u7a0b\u5e8f\u3002</p> <p>\u8be5\u9879\u76ee\u53ea\u652f\u6301\u603b\u63a7\u5f0f\u4e94\u7ea7\u6d41\u6c34\u7ebf\uff0c\u4e0d\u652f\u6301\u63e1\u624b\u4fe1\u53f7\u7684\u4e94\u7ea7\u6d41\u6c34\u7ebf\u3002</p> <p>\u652f\u6301\u7684\u6307\u4ee4\u96c6:RV32IM</p> <p>\u9879\u76ee\u4e3b\u8981\u76ee\u5f55\u5982\u4e0b:</p> <pre><code>pipeline-cpu\n\u251c\u2500\u2500 abstract-machine                 # \u88f8\u673a\u8fd0\u884c\u65f6\u73af\u5883(\u76ee\u524d\u5ffd\u7565\u5b83)\n\u251c\u2500\u2500 IP                               # \u5904\u7406\u5668\u4ee3\u7801\u76ee\u5f55\n\u2502    \u251c\u2500\u2500 pipeline-cpu                   # \u6b64\u76ee\u5f55\u7528\u4e8e\u63a5\u5165\u4f60\u7684\u5355\u5468\u671f\u5904\u7406\u5668\n\u251c\u2500\u2500 software-test                    # \u6d4b\u8bd5\u5904\u7406\u5668\u7684\u8f6f\u4ef6\u7a0b\u5e8f\n\u2502    \u251c\u2500\u2500 benchmarks                     # benchmark\u6d4b\u8bd5\u7a0b\u5e8f\n\u2502    \u2502\u2500\u2500 cpu-tests                      # \u7b80\u5355cpu\u6d4b\u8bd5\u7a0b\u5e8f\n\u251c\u2500\u2500 simulator                        # \u5904\u7406\u5668\u6a21\u62df\u4eff\u771f\u6846\u67b6\n\u2502    \u251c\u2500\u2500 include                        \n\u2502    \u2502   nemu                           # \u7528\u4e8edifftest\u7684nemu\u52a8\u6001\u94fe\u63a5\u5e93\u76ee\u5f55\n\u2502    \u2502   src                            # \u6e90\u4ee3\u7801\u76ee\u5f55\n\u2502    \u2514\u2500\u2500 Makefile                       \n\u251c\u2500\u2500 Makefile                         \n\u2514\u2500\u2500 README.md\n\n</code></pre>"},{"location":"pipeline-cpu/#_2","title":"\u4e8c\u3001\u5b9e\u9a8c\u73af\u5883\u642d\u5efa","text":""},{"location":"pipeline-cpu/#_3","title":"\u914d\u7f6e\u4e00\u89c8","text":"<ul> <li>\u64cd\u4f5c\u7cfb\u7edf\uff1a ubuntu 22.04(LTS), \u975eroot\u8d26\u6237</li> <li>\u4eff\u771f\u5de5\u5177\uff1a Verilator\u3001GTKwave</li> <li>\u7f16\u8bd1\u5de5\u5177\uff1a RISC-V</li> <li>\u7f16\u7a0b\u8bed\u8a00\uff1a Verilog HDL\u3001C\u8bed\u8a00</li> </ul>"},{"location":"pipeline-cpu/#ubuntu","title":"\u5b89\u88c5ubuntu\u7cfb\u7edf","text":"<p>\u70b9\u51fb\u6b64\u5904\u67e5\u770b\u76f8\u5173\u8d44\u6599  ::: tip \u8bb0\u5f97\u66f4\u6362Ubuntu\u8f6f\u4ef6\u6e90</p> <p>\u7531\u4e8e Ubuntu \u9ed8\u8ba4\u8f6f\u4ef6\u6e90\u5728\u56fd\u5185\u8bbf\u95ee\u901f\u5ea6\u8f83\u6162\uff0c\u6211\u4eec\u5efa\u8bae\u5927\u5bb6\u66f4\u6362\u4e3a\u56fd\u5185\u7684\u8f6f\u4ef6\u6e90\uff0c\u4f8b\u5982\u5317\u5916\u955c\u50cf\u6e90\u3002</p> <p>\u5728\u66f4\u6362\u8f6f\u4ef6\u6e90\u540e\uff0c\u8bf7\u4f7f\u7528 sudo apt update \u547d\u4ee4\u66f4\u65b0\u7d22\u5f15\u3002 ::: </p>"},{"location":"pipeline-cpu/#verilator","title":"\u5b89\u88c5Verilator","text":"<p>Verilator \u662f\u4e00\u6b3e\u5f00\u6e90\u7684\u652f\u6301 Verilog \u548c SystemVerilog \u4eff\u771f\u5de5\u5177\u3002\u5b83\u80fd\u591f\u5c06\u7ed9\u5b9a\u7684\u7535\u8def\u8bbe\u8ba1\u7ffb\u8bd1\u6210 C++ \u6216\u8005 SystemC \u7684\u5e93\u7b49\u4e2d\u95f4\u6587\u4ef6\uff0c\u6700\u540e\u4f7f\u7528 C/C++ \u7f16\u5199\u6fc0\u52b1\u6d4b\u8bd5\uff0c\u53bb\u8c03\u7528\u524d\u9762\u751f\u6210\u7684\u4e2d\u95f4\u6587\u4ef6\uff0c\u7531 C/C++ \u7f16\u8bd1\u5668\u7f16\u8bd1\u6267\u884c\uff0c\u6765\u5b8c\u6210\u4eff\u771f\u3002\u6b64\u5916\uff0c\u5b83\u4e5f\u5177\u6709\u9759\u6001\u4ee3\u7801\u5206\u6790\u7684\u529f\u80fd\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u8981\u81ea\u5df1\u7f16\u8bd1\u5b89\u88c5Verilator, \u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863\u3001CSDN\u3001\u548c\u77e5\u4e4e\u3002\u672c\u6587\u4e3b\u8981\u5bf9\u6587\u6863\u5185\u5bb9\u8fdb\u884c\u6574\u7406\uff0c\u5e76\u8865\u5145\u4e00\u4e9b\u7ec6\u8282\u3002 \u4f60\u4e5f\u53ef\u4ee5\u6267\u884c\u4e0b\u5217\u547d\u4ee4\u76f4\u63a5\u5b89\u88c5verilator:</p> <pre><code>sudo apt install verilator\n</code></pre>"},{"location":"pipeline-cpu/#gtkwave","title":"\u5b89\u88c5GTKwave","text":"<pre><code>$ sudo apt install gtkwave\n</code></pre>"},{"location":"pipeline-cpu/#_4","title":"\u5b89\u88c5\u5e93\u6587\u4ef6\u548c\u7f16\u8bd1\u5de5\u5177","text":"<pre><code>$ sudo apt-get install build-essential\n$ sudo apt-get install libreadline-dev\n$ sudo apt-get install llvm-dev\n$ sudo apt-get install g++-riscv64-linux-gnu binutils-riscv64-linux-gnu\n</code></pre> <p>::: tip \u76ee\u524d\u4ecd\u6709\u4e00\u90e8\u5206\u5de5\u5177, \u6682\u672a\u63d0\u4f9b\u5b89\u88c5\u547d\u4ee4\uff0c\u540e\u7eed\u4f1a\u9646\u7eed\u6dfb\u52a0\u652f\u6301\u3002 ::: </p>"},{"location":"pipeline-cpu/#_5","title":"pipeline-cpu\u9879\u76ee\u4f7f\u7528\u6307\u5357","text":""},{"location":"pipeline-cpu/#_6","title":"\u4e09\u3001\u521d\u6b21\u8fd0\u884c\u9879\u76ee","text":""},{"location":"pipeline-cpu/#1","title":"1. \u83b7\u53d6\u9879\u76ee\u4ee3\u7801","text":"<p>\u5728\u547d\u4ee4\u884c\u6216\u7ec8\u7aef\u73af\u5883\u4e0b\uff0c\u6267\u884c\u4e0b\u5217\u547d\u4ee4\u83b7\u53d6\u9879\u76ee\u4ee3\u7801</p> <p>\u5982\u679c\u4e4b\u524d\u5df2\u7ecf\u6267\u884c\u8fc7\u4e0b\u9762\u4ee3\u7801\u514b\u9686\u8fc7\u8be5\u9879\u76ee\uff0c\u53ef\u4ee5\u5728\u9879\u76ee\u76ee\u5f55\u4e0b\u4f7f\u7528<code>git pull</code>\u6765\u83b7\u53d6\u6700\u65b0\u4ee3\u7801 \u6216\u8005\u4e5f\u53ef\u4ee5\u5c06\u5df2\u7ecf\u514b\u9686\u7684\u9879\u76ee\u5220\u9664\u6389\u4e4b\u540e\uff0c\u518d\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u3002 \u6709\u5173<code>git pull</code>\u7684\u4e00\u4e9b\u4f7f\u7528\u65b9\u6cd5\uff0c\u53ef\u4ee5\u901a\u8fc7\u8be2\u95ee<code>AI</code>\u5f97\u77e5</p> <pre><code>$ git clone git@github.com:cs-prj-repo/pipeline-cpu.git\n</code></pre> <p>\u5982\u679c\u4f7f\u7528\u4e0a\u8ff0\u7684git\u514b\u9686\u5931\u8d25\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4</p> <pre><code>$ git clone https://github.com/cs-prj-repo/single-cycle-cpu.git\n</code></pre> <p>\u5982\u679c\u518d\u6b21\u514b\u9686\u5931\u8d25\u5e76\u4e14\u4f7f\u7528\u7684\u662f\u865a\u62df\u673a\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e0b\u8f7d\u538b\u7f29\u5305\u5e76\u4e14\u4f7f\u7528<code>scp</code>\u76f8\u5173\u547d\u4ee4\uff0c\u5c06\u6587\u4ef6\u62f7\u8d1d\u5230\u865a\u62df\u673a\u91cc\u9762\u3002</p>"},{"location":"pipeline-cpu/#2","title":"2. \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf","text":"<p>\u5728\u4f60\u7684<code>~/.bashrc</code>\u6587\u4ef6\u5f53\u4e2d\u6dfb\u52a0\u5982\u4e0b\u7684\u73af\u5883\u53d8\u91cf\uff0c\u6dfb\u52a0\u5b8c\u6210\u540e\uff0c\u6267\u884c<code>source ~/.bashrc</code>\u547d\u4ee4 \u6709\u5173\u5982\u4f55\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\uff0c\u53ef\u4ee5\u901a\u8fc7\u8be2\u95ee<code>AI</code>\u5f97\u77e5</p> <pre><code>\nexport CPU_HOME=pipeline-cpu\u76ee\u5f55\u7684\u7edd\u5bf9\u8def\u5f84 #\u590d\u5236\u540e\u8bb0\u5f97\u4fee\u6539,\u6ce8\u610f\u8bb0\u5f97\u662f\u7edd\u5bf9\u8def\u5f84\nexport SIM_HOME=$CPU_HOME/simulator          #\u76f4\u63a5\u590d\u5236\u5373\u53ef\nexport AM_HOME=$CPU_HOME/abstract-machine    #\u76f4\u63a5\u590d\u5236\u5373\u53ef\nexport TEST_HOME=$CPU_HOME/software-test     #\u76f4\u63a5\u590d\u5236\u5373\u53ef\n</code></pre>"},{"location":"pipeline-cpu/#3","title":"3. \u8fd0\u884c\u9879\u76ee\u6846\u67b6\u9ed8\u8ba4\u7684\u5904\u7406\u5668\u548c\u5185\u7f6e\u7a0b\u5e8f","text":"<p>\u5728\u547d\u4ee4\u884c\u6216\u7ec8\u7aef\u73af\u5883\u4e0b\u6267\u884c\u4e0b\u9762\u547d\u4ee4\uff0c\u5c1d\u8bd5\u4f7f\u7528\u9879\u76ee\u6846\u67b6\u9ed8\u8ba4\u7684\u5904\u7406\u5668\u8fd0\u884c\u5185\u7f6e\u7a0b\u5e8f\u3002</p> <pre><code>$ cd $SIM_HOME\n$ make run\n</code></pre> <p>\u5982\u679c\u9879\u76ee\u8fd0\u884c\u540e\u51fa\u73b0\u4e00\u4e2a\u7eff\u8272\u7684<code>HIT GOOD TRAP</code>\uff0c\u8bf4\u660e\u7a0b\u5e8f\u8fd0\u884c\u6210\u529f\uff0c\u4e00\u5207\u6b63\u5e38\u3002</p> <p>\u5982\u679c\u9879\u76ee\u8fd0\u884c\u540e\u51fa\u73b0\u7f16\u8bd1\u62a5\u9519\uff0c\u8bf7\u81ea\u884c\u4fee\u590d\uff0c\u6216\u8054\u7cfb\u6211\u4eec\u5e76\u63d0\u4f9b\u62a5\u9519\u622a\u56fe\uff0c\u5e2e\u52a9\u6211\u4eec\u4fee\u590d\u9519\u8bef\u3002</p> <p>\u5982\u679c\u9879\u76ee\u8fd0\u884c\u540e\u51fa\u73b0\u4e00\u4e2a\u7ea2\u8272\u7684<code>HIG BAD TRAP</code>, \u8bf4\u660e\u5904\u7406\u5668\u6267\u884c\u6307\u4ee4\u65f6\u51fa\u9519\uff0c\u4e00\u822c\u662f\u5904\u7406\u5668\u5b9e\u73b0\u95ee\u9898\u3002</p> <p>::: tip \u9879\u76ee\u6846\u67b6\u7684\u4eff\u771f\u73af\u5883\u5bf9\u4e8e\u8bbf\u5b58\u7684\u8981\u6c42</p> <p>\u76ee\u524d\u9879\u76ee\u6846\u67b6\u652f\u6301\u7684\u5185\u5b58\u4e3a128MB, \u5730\u5740\u7a7a\u95f4\u4e3a[0x80000000, 0x8fffffff], \u6ce8\u610f\u5728\u8bbf\u5b58\u65f6\u4e0d\u8981\u8d85\u51fa\u8be5\u5730\u5740\u7a7a\u95f4\u8303\u56f4</p> <p>:::  ::: tip \u5904\u7406\u5668\u8fd0\u884c\u7684\u5185\u7f6e\u7a0b\u5e8f \u5f53\u5728<code>simluator</code>\u76ee\u5f55\u4e0b\u6267\u884c<code>make run</code>\u65f6\uff0c\u65e0\u8bba\u9879\u76ee\u6307\u5b9a\u54ea\u4e2a\u5904\u7406\u5668\u8fd0\u884c\uff0c\u90fd\u4f1a\u8fd0\u884c\u4e00\u4e2a\u5185\u7f6e\u7684\u7a0b\u5e8f \u8fd9\u6bb5\u5185\u7f6e\u7a0b\u5e8f\u6307\u4ee4\u5b58\u653e\u5728<code>simulator/src/monitor/monitor.c</code>\u6587\u4ef6\u4e0b\uff0c\u5176\u540d\u79f0\u4e3a<code>static const uint32_t img[]</code></p> <p>\u5728\u8fd0\u884c\u4f60\u7684\u5904\u7406\u5668\u7684\u65f6\u5019\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u8981\u6765\u4fee\u6539\u6b64\u5904\u4ee3\u7801\u6765\u8fd0\u884c\u6307\u5b9a\u7684\u7a0b\u5e8f\u6307\u4ee4</p> <p>\u6ce8\u610f\u5185\u7f6e\u7a0b\u5e8f\u6307\u4ee4\u4e00\u5b9a\u8981\u5305\u542b\u4e00\u6761<code>ebreak</code>\u6307\u4ee4 :::</p> <p>::: tip \u4eff\u771f\u73af\u5883\u5982\u4f55\u5224\u5b9a\u7a0b\u5e8f\u6267\u884c\u7ed3\u675f \u9879\u76ee\u6846\u67b6\u901a\u8fc7\u6307\u5b9a<code>ebreak</code>\u6307\u4ee4\u4e3a\u7a0b\u5e8f\u7ed3\u675f\u7684\u6307\u4ee4\u6765\u5224\u65ad\u4e00\u4e2a\u7a0b\u5e8f\u662f\u5426\u8fd0\u884c\u7ed3\u675f\u3002</p> <p>\u5728\u6267\u884c\u7a0b\u5e8f\u65f6\uff0c\u9879\u76ee\u6846\u67b6\u4f1a\u5728\u6bcf\u4e2a\u7a0b\u5e8f\u7684\u6700\u540e\u6ce8\u5165\u4e00\u6761<code>ebraek</code>\u6307\u4ee4\u6765\u8fbe\u5230\u8be5\u6548\u679c\u3002</p> <p>\u7531\u4e8e\u5185\u7f6e\u7a0b\u5e8f\u662f\u7528\u6237\u53ef\u4ee5\u81ea\u884c\u4fee\u6539\u7684\uff0c\u6240\u4ee5\u5185\u7f6e\u7a0b\u5e8f\u7684<code>ebreak</code>\u6307\u4ee4\u9700\u8981\u7531\u7528\u6237\u81ea\u5df1\u6dfb\u52a0\u3002 :::</p> <p>::: tip \u5f00\u542f/\u5173\u95edDifftest \u9879\u76ee\u9700\u8981\u4f7f\u7528DIfftest\u6280\u672f\u6765\u9a8c\u8bc1\u5904\u7406\u5668\u5b9e\u73b0\u662f\u5426\u6b63\u786e\u3002</p> <p>\u9879\u76ee\u4e2dDifftest\u9ed8\u8ba4\u5904\u4e8e\u5f00\u542f\u72b6\u6001</p> <p>\u5728<code>simulator/inlcude/utils/open_sim_difftest.h</code>\u6587\u4ef6\u4e2d \u53ef\u4ee5\u901a\u8fc7\u6ce8\u91ca\u6216\u8005\u89e3\u5f00\u6ce8\u91ca<code>#define CONFIG_DIFFTEST 1</code>\u6765\u6253\u5f00\u6216\u5173\u95edDifftest\u529f\u80fd</p> <p>\u6ce8\u610f\uff0c\u5f00\u542fDifftest\u4f1a\u51cf\u7f13\u7a0b\u5e8f\u8fd0\u884c\u65f6\u95f4\uff0c\u5728\u8fdb\u884cbenchmarck\u7a0b\u5e8f\u5bf9\u5904\u7406\u5668\u8fdb\u884c\u8dd1\u5206\u65f6\uff0c\u5efa\u8bae\u5173\u95edDifftest :::</p> <p>::: tip \u5f00\u542f/\u5173\u95ed\u6ce2\u5f62\u8ffd\u8e2a \u5728\u5904\u7406\u5668\u8fd0\u884c\u65f6\uff0c\u4eff\u771f\u6846\u67b6\u53ef\u4ee5\u8ffd\u8e2a\u5230\u5904\u7406\u5668\u8fd0\u884c\u7a0b\u5e8f\u7684\u6ce2\u5f62\u4fe1\u606f\u3002</p> <p>\u9879\u76ee\u9ed8\u8ba4\u6ce2\u5f62\u8ffd\u8e2a\u5904\u4e8e\u5173\u95ed\u72b6\u6001</p> <p>\u5728<code>simulator/inlcude/utils/open_sim_difftest.h</code>\u6587\u4ef6\u4e2d \u53ef\u4ee5\u901a\u8fc7\u6ce8\u91ca\u6216\u8005\u89e3\u5f00\u6ce8\u91ca<code>#define CONFIG_NPC_OPEN_SIM 1</code>\u6765\u6253\u5f00\u6216\u5173\u95ed\u6ce2\u5f62\u8ffd\u8e2a\u529f\u80fd</p> <p>\u8c28\u8bb0\uff0c\u5982\u679c\u5f00\u542f\u6ce2\u5f62\u8fd0\u884c\u5927\u578b\uff0c\u5219\u4f1a\u751f\u6210\u975e\u5e38\u5927\u7684\u6ce2\u5f62\u6587\u4ef6\uff0c\u9ad8\u8fbe1G-50GB\uff0c\u6709\u53ef\u80fd\u4f1a\u635f\u5bb3\u78c1\u76d8</p> <p>\u56e0\u6b64\uff0c\u5f53\u8fd0\u884c\u4e00\u4e9b\u5927\u578b\u7a0b\u5e8f\u65f6\uff0c\u6bd4\u5982benchmark\uff0c\u4e00\u5b9a\u4e0d\u8981\u5f00\u542f\u6ce2\u5f62\u8ffd\u8e2a\u3002</p> <p>\u5982\u4f55\u4f7f\u7528\u66f4\u5c0f\u7684\u6ce2\u5f62\u6587\u4ef6\u683c\u5f0f\uff0c\u5982fst\uff0c\u6b63\u5728\u5f00\u53d1\u4e2d\u3002 :::</p>"},{"location":"pipeline-cpu/#4-riscv32","title":"4. \u4fee\u590driscv32\u7f16\u8bd1\u9519\u8bef","text":"<p>\u7b2c\u4e00\u6b21\u8fd0\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u4f1a\u51fa\u73b0\u4e00\u4e2a\u7f16\u8bd1\u9519\u8bef\uff0c\u6211\u4eec\u6765\u4fee\u590d\u5b83\u3002</p> <pre><code>$ cd $TEST_HOME/cpu-tests\n$ make run ARCH=riscv32-npc ALL=dummy\n</code></pre> <p>\u5982\u679c\u9047\u5230\u4e86\u4ee5\u4e0b\u9519\u8bef: <code>/usr/riscv64-linux-gnu/include/bits/wordsize.h:28:3: error: #error \"rv32i-based targets are not supported\"</code> \u90a3\u4e48\u4f7f\u7528<code>sudo</code>\u6743\u9650\u4fee\u6539<code>/usr/riscv64-linux-gnu/include/bits/wordsize.h</code>\u6587\u4ef6</p> <pre><code> #if __riscv_xlen == 64\n # define __WORDSIZE_TIME64_COMPAT32 1\n #else\n    # error \"rv32i-based targets are not supported\" -----&gt;\u5c06\u8fd9\u4e00\u884c\u6ce8\u91ca\u6389\n    # define __WORDSIZE_TIME64_COMPAT32 0           -----&gt;\u5728\u4e0b\u9762\u65b0\u589e\u8fd9\u4e00\u884c\n #endif\n</code></pre> <p>\u5982\u679c\u9047\u5230\u4e86\u4ee5\u4e0b\u9519\u8bef\uff1a <code>/usr/riscv64-linux-gnu/include/gnu/stubs.h:8:11: fatal error: gnu/stubs-ilp32.h: No such file or directory</code> \u90a3\u4e48\u4f7f\u7528<code>sudo</code>\u6743\u9650\u4fee\u6539<code>/usr/riscv64-linux-gnu/include/gnu/stubs.h</code>\u6587\u4ef6 \u5c06\u6587\u4ef6\u7684<code># include &lt;gnu/stubs-ilp32.h&gt;</code>\u8fd9\u6bb5\u4ee3\u7801\u6ce8\u91ca\u6389 </p> <p> </p>"},{"location":"pipeline-cpu/#_7","title":"\u56db\u3001\u8fd0\u884c\u6d4b\u8bd5\u7a0b\u5e8f","text":"<p>\u4e0b\u9762\u63d0\u4f9b\u4e86\u591a\u4e2a\u53ef\u4ee5\u8fd0\u884c\u6d4b\u8bd5\u7a0b\u5e8f\u7684\u547d\u4ee4\uff0c\u9009\u62e9\u5176\u4e2d\u4e00\u90e8\u5206\u8fd0\u884c\u5373\u53ef</p> <p>::: tip \u8fd0\u884c\u7a0b\u5e8f\u5bf9\u5904\u7406\u5668\u7684\u8981\u6c42 \u7531\u4e8e\u6211\u4eec\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u662f\u53ef\u8fd0\u884c\u7684\u7a0b\u5e8f\uff0c\u4e00\u4e2a\u53ef\u8fd0\u884c\u7a0b\u5e8f\u8981\u6c42\u5904\u7406\u5668\u5fc5\u987b\u80fd\u591f\u6267\u884c<code>auipc</code>, <code>jal</code>,<code>addi</code>\u6307\u4ee4 ::: </p>"},{"location":"pipeline-cpu/#riscv","title":"\u8fd0\u884criscv\u5b98\u65b9\u6307\u4ee4\u96c6\u6d4b\u8bd5\u96c6\u5408","text":"<p>\u5728\u9879\u76ee\u63d0\u4f9b\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u4e2d\uff0c\u5b98\u65b9\u6d4b\u8bd5\u96c6\u7a0b\u5e8f\u662f\u6700\u5b8c\u5907\u7684\u6d4b\u8bd5\u96c6\u7a0b\u5e8f\uff0c\u68c0\u6d4b\u51c6\u786e\u5ea6\u6700\u9ad8</p> <p>\u52a1\u5fc5\u4ee5\u8be5\u6d4b\u8bd5\u96c6\u7a0b\u5e8f\u4f5c\u4e3a\u5904\u7406\u5668\u6d4b\u8bd5\u662f\u5426\u901a\u8fc7\u7684\u6807\u51c6 1. \u514b\u9686riscv\u5b98\u65b9\u6307\u4ee4\u96c6\u6d4b\u8bd5\u4ed3\u5e93\uff0c\u53ef\u4ee5\u514b\u9686\u5230\u4efb\u610f\u76ee\u5f55</p> <pre><code>$ git clone git@github.com:cs-prj-repo/riscv-tests-am.git\n</code></pre> <ol> <li>\u8fd0\u884criscv\u5b98\u65b9\u6d4b\u8bd5\u96c6\u7a0b\u5e8f</li> </ol> <p>\u5728\u547d\u4ee4\u884c\u6216\u7ec8\u7aef\u4e0b\u6267\u884c\u4e0b\u9762\u7684\u4ee3\u7801\u8fd0\u884c\u6d4b\u8bd5\u96c6\u7a0b\u5e8f</p> <pre><code>#\u8fd0\u884criscv\u5b98\u65b9\u6307\u4ee4\u96c6\u6d4b\u8bd5\u7a0b\u5e8f\uff1a\ncd xxx/riscv-tests-am\nmake run ARCH=riscv32-npc ALL=\u60f3\u8981\u6d4b\u8bd5\u7684\u6307\u4ee4\n\n#\u793a\u4f8b1-\u6d4b\u8bd5add\u6307\u4ee4\u5b9e\u73b0\u662f\u5426\u6b63\u786e\uff1a\ncd xxx/riscv-tests-am\nmake run ARCH=riscv32-npc ALL=add\n\n#\u793a\u4f8b2-\u6d4b\u8bd5sub\u6307\u4ee4\u5b9e\u73b0\u662f\u5426\u6b63\u786e\ncd xxx/riscv-tests-am\nmake run ARCH=riscv32-npc ALL=sub\n\n#\u793a\u4f8b3-\u6d4b\u8bd5\u6240\u6709\u6307\u4ee4\u5b9e\u73b0\u662f\u5426\u6b63\u786e\ncd xxx/riscv-tests-am\nmake run ARCH=riscv32-npc\n</code></pre> <p> </p>"},{"location":"pipeline-cpu/#cpu-tests","title":"\u8fd0\u884ccpu-tests\u76ee\u5f55\u4e0b\u7684\u6d4b\u8bd5\u96c6\u7a0b\u5e8f:","text":"<p>cpu-tests\u76ee\u5f55\u4e0b\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u53ea\u662f\u4e00\u4e9b\u7b80\u5355\u7684\u6d4b\u8bd5\u7a0b\u5e8f, \u6d4b\u8bd5\u51c6\u786e\u7387\u5e76\u4e0d\u9ad8</p> <p>cpu-tests\u76ee\u5f55\u4e0b\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u91cc\u6709\u4e00\u4e9b\u542b\u6709M\u7c7b\u6307\u4ee4, \u5982\u679c\u4f60\u7684\u5904\u7406\u5668\u53ea\u652f\u6301RV32I\uff0c\u4f1a\u6709\u4e00\u4e9b\u6d4b\u8bd5\u65e0\u6cd5\u901a\u8fc7\uff0c\u8fd9\u662f\u6b63\u5e38\u7684\uff0c\u8bf7\u4e0d\u8981\u62c5\u5fc3\u3002</p> <p>\u5728\u547d\u4ee4\u884c\u6216\u7ec8\u7aef\u4e0b\u6267\u884c\u4e0b\u9762\u7684\u4ee3\u7801\u8fd0\u884c\u6d4b\u8bd5\u96c6\u7a0b\u5e8f</p> <pre><code>#\u8fd0\u884c\u6d4b\u8bd5\u96c6\u7a0b\u5e8f\u7684\u6846\u67b6\u4ee3\u7801\uff1a\ncd $TEST_HOME/cpu-tests\nmake run ARCH=riscv32-npc ALL=\u60f3\u8fd0\u884c\u7684\u7a0b\u5e8f\n\n#\u793a\u4f8b2-\u8fd0\u884cstring\u7a0b\u5e8f\uff1a\ncd $TEST_HOME/cpu-tests\nmake run ARCH=riscv32-npc ALL=dummy\n\n#\u793a\u4f8b1-\u8fd0\u884cdummy\u7a0b\u5e8f\uff1a\ncd $TEST_HOME/cpu-tests\nmake run ARCH=riscv32-npc ALL=dummy\n\n#\u793a\u4f8b3-\u8fd0\u884c\u6240\u6709\u7a0b\u5e8f\uff1a\ncd $TEST_HOME/cpu-tests\nmake run ARCH=riscv32-npc\n</code></pre> <p></p>"},{"location":"pipeline-cpu/#benchmarks","title":"\u8fd0\u884cbenchmarks\u76ee\u5f55\u4e0b\u7684\u6d4b\u8bd5\u96c6\u7a0b\u5e8f:","text":"<p>::: tip pipeline\u6682\u65f6\u5148\u4e0d\u6d4b\u8bd5benchmarks :::</p> <p>::: tip \u5c0f\u603b\u7ed3 \u901a\u8fc7\u6267\u884c\u4ee5\u4e0a\u547d\u4ee4\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e0b\u9762\u7684\u89c4\u5f8b:</p> <p>\u5982\u679c\u6d4b\u8bd5\u7a0b\u5e8f\u96c6\u91cc\u9762\u6709\u591a\u4e2a\u6d4b\u8bd5\u7a0b\u5e8f \u6267\u884c<code>make run ARCH=riscv32-npc ALL=xxx</code>\u53ea\u4f1a\u8fd0\u884c\u4e00\u4e2a\u53eb\u505a<code>xxx</code>\u7684\u6d4b\u8bd5\u7a0b\u5e8f \u6267\u884c<code>make run ARCH=riscv32-npc</code> \u4f1a\u8fd0\u884c\u6240\u6709\u7a0b\u5e8f</p> <p>::: </p>"},{"location":"pipeline-cpu/#csr","title":"\u8fd0\u884cCSR\u6307\u4ee4\u6d4b\u8bd5\u7a0b\u5e8f","text":"<p>::: tip CSR\u6d4b\u8bd5\u7a0b\u5e8f\u6ce8\u610f\u4e8b\u9879 CSR\u6d4b\u8bd5\u7a0b\u5e8f\u867d\u7136\u5df2\u7ecf\u79fb\u690d\uff0c\u4e0d\u8fc7\u4eff\u771f\u6846\u67b6\u6682\u65f6\u4e0d\u652f\u6301\u5176\u6d4b\u8bd5---\u5168\u529b\u5f00\u53d1\u4e2d ::: \u5f53\u4f60\u5b9e\u73b0\u4e86<code>mret</code>,<code>ecall</code>,<code>csrrw</code>, <code>csrrs</code>\u6307\u4ee4\u4e4b\u540e, \u53ef\u4ee5\u8fd0\u884c<code>yield-os</code>\u6d4b\u8bd5\u7a0b\u5e8f\u3002 \u5982\u679c\u5904\u7406\u5668\u5b9e\u73b0\u6b63\u786e\uff0c\u6d4b\u8bd5\u7a0b\u5e8f\u4f1a\u7f13\u6162\u51fa\u73b0\u5b57\u6bcd<code>ABABAB</code>\u7684\u5e8f\u5217\u3002 \u5982\u679c\u5904\u7406\u5668\u5b9e\u73b0\u51fa\u9519\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u4e0d\u662f\u90a3\u4e48\u7684\u597d\u8c03\u8bd5\uff0c\u56e0\u4e3a\u6d89\u53ca\u5230\u5404\u79cd\u9677\u5165\uff0c\u6bd4\u8f83\u590d\u6742---&gt;\u5f85\u6539\u8fdb</p> <p>\u6267\u884c\u4e0b\u5217\u547d\u4ee4\uff0c\u8fd0\u884c<code>yield-os</code>\u6d4b\u8bd5\u7a0b\u5e8f</p> <pre><code>cd $TEST_HOME/csr-tests/yield-os\nmake run ARCH=riscv32-npc\n</code></pre>"},{"location":"pipeline-cpu/#_8","title":"\u4e94\u3001\u6307\u5b9a\u9879\u76ee\u8fd0\u884c\u4f60\u7684\u5904\u7406\u5668","text":"<p>\u9996\u5148\u5728<code>pipelinc-cpu/IP</code>\u76ee\u5f55\u4e0b\u9762\u65b0\u5efa\u4e00\u4e2a\u76ee\u5f55\uff0c\u76ee\u5f55\u7684\u540d\u79f0\u4e0d\u4f5c\u4efb\u4f55\u8981\u6c42\u3002 \u4e0b\u6587\u5c06\u4f7f\u7528<code>your_cpu_dir</code>\u4ee3\u6307\u4f60\u65b0\u5efa\u7684\u76ee\u5f55, \u5c06\u4f60\u7684\u5904\u7406\u5668\u4ee3\u7801\u5168\u90e8\u653e\u5230<code>your_cpu_dir</code>\u76ee\u5f55\u4e0b \u6700\u540e\u518d\u901a\u8fc7simulator/Makefile\u4e2d\u7684<code>CPU_DIR</code>\u53d8\u91cf\u4e3a\u4f60\u7684\u5904\u7406\u5668\u76ee\u5f55\u8def\u5f84\uff0c\u6765\u6307\u5b9a\u9879\u76ee\u8fd0\u884c\u4f60\u7684\u5904\u7406\u5668 ::: warning \u6ce8\u610fdefine.v\u6587\u4ef6\u5fc5\u987b\u548c\u4f60\u7684\u5904\u7406\u5668\u540c\u5728\u4e00\u4e2a\u76ee\u5f55\u4e0b\u9762 :::</p> <p>::: tip \u793a\u4f8b \u9879\u76ee\u901a\u8fc7<code>simulator/Makefile</code>\u4e2d\u7684<code>CPU_DIR :=$(CPU_HOME)/IP/pipeline-cpu</code>\u6307\u5b9a\u4e86\u9879\u76ee\u4f1a\u8fd0\u884c<code>pipeline-cpu\u76ee\u5f55\u4e0b\u7684\u5904\u7406\u5668</code></p> <p>\u901a\u8fc7\u4fee\u6539<code>CPU_DIR :=$(CPU_HOME)/IP/\u4f60\u7684\u5904\u7406\u5668\u76ee\u5f55\u540d\u5b57</code>, \u53ef\u4ee5\u6307\u5b9a\u9879\u76ee\u8fd0\u884c<code>\u4f60\u7684\u5904\u7406\u5668</code></p> <p>\u793a\u4f8b\uff1a \u82e5<code>simulator/Makefile</code>\u4e2d\u7684<code>CPU_DIR :=$(CPU_HOME)/IP/AAA</code>, \u5219\u9879\u76ee\u4f1a\u8fd0\u884c<code>AAA</code>\u76ee\u5f55\u4e0b\u7684\u5904\u7406\u5668</p> <p>:::</p>"},{"location":"pipeline-cpu/#_9","title":"\u516d\u3001\u5c06\u4f60\u7684\u5904\u7406\u5668\u63a5\u5165\u4eff\u771f\u73af\u5883","text":"<p>\u4e3a\u4e86\u652f\u6301\u6240\u6709\u7684\u5355\u5468\u671f\u5904\u7406\u5668\u90fd\u53ef\u4ee5\u63a5\u5165\u8be5\u4eff\u771f\u3001\u6d4b\u8bd5\u73af\u5883, \u4eff\u771f\u73af\u5883\u5bf9\u8fd0\u884c\u7684\u5904\u7406\u5668\u6709\u4e00\u5b9a\u7684\u8981\u6c42</p>"},{"location":"pipeline-cpu/#1-top_module_name","title":"1. \u4eff\u771f\u6846\u67b6\u5bf9\u4e8e\u5904\u7406\u5668\u6700\u9876\u5c42\u6a21\u5757\u540d\u79f0<code>TOP_Module_Name</code>\u7684\u8981\u6c42","text":"<p>\u4e3a\u4e86\u652f\u6301\u6240\u6709\u7684\u5355\u5468\u671f\u5904\u7406\u5668\u90fd\u53ef\u4ee5\u63a5\u5165\u8be5\u4eff\u771f\u3001\u6d4b\u8bd5\u73af\u5883\uff0c\u6211\u4eec\u9884\u5148\u8bbe\u5b9a\u4e86\u4e00\u4e2a\u6700\u9876\u5c42\u7684\u4eff\u771f\u6a21\u5757\u540d\u79f0\uff0c\u5373<code>TOP_Module_Name=CPU</code>\u4e5f\u5c31\u662f\u8bf4\u5904\u7406\u5668\u6700\u9876\u5c42\u6a21\u5757\u540d\u79f0\u5fc5\u987b\u662f<code>CPU</code> ::: warning \u4eff\u771f\u6846\u67b6\u53ea\u5bf9TOP_Module_Name\u6709\u6b64\u8981\u6c42\uff0c\u5bf9\u6240\u6709\u7684verilog\u4ee3\u7801\u6587\u4ef6\u540d\uff0c\u5176\u4ed6\u6a21\u5757\u540d\u79f0\u5747\u6ca1\u6709\u4efb\u4f55\u8981\u6c42\u3002 :::</p> <p>::: tip \u81ea\u5b9a\u4e49\u4f60\u7684\u5904\u7406\u5668TOP_Module_Name</p> <p>\u9879\u76ee\u901a\u8fc7<code>simulator/Makefile</code>\u4e2d\u7684<code>TOPNAME :=CPU</code>\u6307\u5b9a\u4e86\u5904\u7406\u5668\u6700\u9876\u5c42\u6a21\u5757\u540d\u79f0<code>TOP_Module_Name</code>\u5fc5\u987b\u4e3a<code>CPU</code></p> <p>\u901a\u8fc7\u4fee\u6539<code>TOPNAME :=\u4f60\u5199\u7684\u6a21\u5757\u540d</code>, \u53ef\u4ee5\u6307\u5b9a\u5904\u7406\u5668\u6700\u9876\u5c42\u6a21\u5757\u540d\u79f0\u4e3a<code>\u4f60\u5199\u7684\u6a21\u5757\u540d</code></p> <p>\u793a\u4f8b\uff1a \u82e5<code>simulator/Makefile</code>\u4e2d\u7684<code>TOPNAME :=AAA</code>, \u5219\u5904\u7406\u5668\u6700\u9876\u5c42\u6a21\u5757\u540d\u79f0\u9700\u8981\u4e3a<code>AAA</code> :::  </p>"},{"location":"pipeline-cpu/#2_1","title":"2. \u4eff\u771f\u6846\u67b6\u5bf9\u5904\u7406\u5668\u6700\u9876\u5c42\u6a21\u5757\u7684\u4fe1\u53f7\u8981\u6c42","text":"<p>\u65e0\u8bba\u5904\u7406\u5668\u9876\u5c42\u6a21\u5757\u7684\u6a21\u5757\u540d\u662f\u4ec0\u4e48\uff0c\u5b83\u90fd\u5fc5\u987b\u5e26\u6709\u4e0b\u9762\u4e09\u4e2a\u4fe1\u53f7<code>clk</code>, <code>rst</code>, <code>cur_pc</code>, <code>commit</code>, <code>commit_pc</code>, <code>commit_pre_pc</code>, \u8fd9\u51e0\u4e2a\u4fe1\u53f7\u7684\u8bf4\u660e\u5982\u4e0b</p> <pre><code>module CPU(\n    input wire clk,\n    input wire rst,\n    output wire [31:0]          cur_pc,\n    output                      commit,\n    output wire [31:0]          commit_pc,\n    output wire [31:0]          commit_pre_pc\n);\n\nendmodule\n</code></pre> <p>\u7531\u4e8e\u4eff\u771f\u6846\u67b6\u9700\u8981\u6355\u6349\u521a\u521a\u6267\u884c\u5b8c\u7684\u4e00\u6761\u6307\u4ee4\u7684<code>pc</code>\u548c<code>instr</code>\uff0c\u5e76\u4e14\u4e94\u7ea7\u6d41\u6c34\u7ebf\u5f53\u4e2d\u6700\u591a\u4f1a\u540c\u65f6\u6267\u884c\u4e94\u6761\u6307\u4ee4\uff0c\u56e0\u6b64\u4eff\u771f\u6846\u67b6\u4f1a\u5f88\u96be\u5224\u65ad\u4ec0\u4e48\u65f6\u5019\u4e00\u6761\u6307\u4ee4\u6267\u884c\u5b8c\u6bd5\u4e86\uff0c\u521a\u521a\u6267\u884c\u5b8c\u7684\u4e00\u6761\u6307\u4ee4\u5230\u5e95\u662f\u4ec0\u4e48\u6307\u4ee4\uff0c\u4e3a\u4e86\u786e\u4fdd\u4eff\u771f\u6846\u67b6\u53ef\u4ee5\u6355\u6349\u5230\u6d41\u6c34\u7ebf\u5904\u7406\u5668\u4e2d\u771f\u6b63\u6267\u884c\u5b8c\u6bd5\u7684\u90a3\u6761\u6307\u4ee4\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u6846\u67b6\u7684\u4eff\u771f\u4fe1\u53f7\u505a\u51fa\u4e00\u5b9a\u7684\u4fee\u6539\u3002</p> <p>\u4eff\u771f\u6846\u67b6\u4f7f\u7528\u7684\u7b56\u7565\u5982\u4e0b\uff0c\u5f53\u4e00\u6761\u6307\u4ee4\u4ece\u53d6\u6307\u9636\u6bb5\u5230\u8fbe\u5199\u56de\u9636\u6bb5\u540e\uff0c\u4eff\u771f\u6846\u67b6\u5c31\u5224\u5b9a\u4e00\u6761\u6307\u4ee4\u6267\u884c\u5b8c\u6bd5\u4e86\u3002 \u5728\u5177\u4f53\u5b9e\u73b0\u4e0a\uff0c\u6211\u4eec\u901a\u8fc7\u8ba9<code>pc</code>, <code>commit</code>, <code>instr</code>, <code>pre_pc</code>\u4e00\u8d77\u968f\u7740\u6d41\u6c34\u7ebf\u5f80\u540e\u6d41\u52a8\u5230\u8fbe\u5199\u56de\u9636\u6bb5\uff0c\u7136\u540e\u4eff\u771f\u6846\u67b6\u5bf9\u5230\u8fbe\u5199\u56de\u9636\u6bb5\u7684\u4fe1\u53f7\u8fdb\u884c\u68c0\u6d4b</p> <p>::: tip \u603b\u7ed3-\u6d41\u6c34\u7ebf\u5904\u7406\u5668\u9700\u8981\u5411\u4eff\u771f\u73af\u5883\u4f20\u9012\u7684\u4fe1\u53f7 <code>cur_pc</code>  \u662f\u5f53\u524d<code>pc</code>\u5bc4\u5b58\u5668\u7684\u503c</p> <p><code>pre_pc</code>\u4fe1\u53f7: \u5411\u4eff\u771f\u4fe1\u53f7\u4f20\u9012\u7684<code>pre_pc</code>\u503c\u9700\u8981\u662f\u6b63\u786e\u7684<code>pre_pc</code>\u503c\u3002 \u5982\u679c\u4e00\u6761\u5206\u652f\u6307\u4ee4\u5728\u6267\u884c\u9636\u6bb5\u5224\u65ad\u51fa\u4f1a\u8df3\u8f6c\uff0c\u90a3\u4e48<code>pre_pc</code>\u9700\u8981\u662f\u8df3\u8f6c\u540e\u7684\u5730\u5740</p> <p><code>commmit_pc</code>\u4fe1\u53f7:  \u662f\u5728\u6d41\u6c34\u7ebf\u91cc\u9762\u6d41\u5230\u5199\u56de\u9636\u6bb5\u7684\u90a3\u6761\u6307\u4ee4\u7684pc\u503c,\u4e0d\u662f\u5f53\u524dPC\u5bc4\u5b58\u5668\u7684pc\u503c</p> <p><code>commit</code>\u4fe1\u53f7: \u53ef\u4ee5IP/pipeline-cpu/fetch.v</p> <p><code>commit_instr</code>\u4fe1\u53f7 \u662f\u5728\u6d41\u6c34\u7ebf\u91cc\u9762\u6d41\u5230\u5199\u56de\u9636\u6bb5\u7684\u90a3\u6761\u6307\u4ee4</p> <p>::: \u5177\u4f53\u4fe1\u53f7\u53ef\u4ee5\u53c2\u8003\u4e0b\u56fe</p> <p></p> <p></p>"},{"location":"pipeline-cpu/#3-clkrst","title":"3. \u4eff\u771f\u6846\u67b6\u4e2d<code>clk</code>\u548c<code>rst</code>\u4fe1\u53f7\u7684\u4f7f\u7528\u8981\u6c42","text":"<p>\u4eff\u771f\u6846\u67b6<code>clk</code>\u548c<code>rst</code>\u4fe1\u53f7\u7684\u4f7f\u7528\u8981\u6c42\u5982\u4e0b\uff1a</p> <pre><code>//\u6211\u4eec\u53ea\u6355\u6349\u65f6\u949f\u4e0a\u5347\u6cbf\u7684\u4fe1\u53f7\u8fdb\u884c\u5904\u7406\uff0c\u793a\u4f8b\u5982\u4e0b\nalways @(posedge clk) begin\n\nend\n\n//rst\u5728\u9ad8\u7535\u5e73\u65f6\u8fdb\u884c\u590d\u4f4d\nalways @(posedge clk) begin\n    if(rst) begin        //\u9ad8\u7535\u5e73\u65f6\u8fdb\u884c\u590d\u4f4d\n        regfile[0] &lt;= 32'h0\n    end \n    else begin\n        //other code\n    end\nend\n\n</code></pre> <p></p>"},{"location":"pipeline-cpu/#4-pc","title":"4. \u4eff\u771f\u6846\u67b6\u5bf9\u4e8epc\u590d\u4f4d\u503c\u7684\u8981\u6c42","text":"<p><code>pc</code>\u521d\u59cb\u590d\u4f4d\u503c\u5fc5\u987b\u4e3a<code>0x80000000</code></p> <pre><code>always @(posedge clk) begin\n    if(rst) begin\n        pc &lt;= 32'h80000000; //32\u4f4d\u64cd\u4f5c\u7cfb\u7edf\n    end\nend\n</code></pre> <p></p>"},{"location":"pipeline-cpu/#5-dpi-c","title":"5. \u63a5\u5165\u4eff\u771f\u6846\u67b6\u7684DPI-C\u673a\u5236","text":"<p>\u6211\u4eec\u4f7f\u7528Verilator\u7684DPI-C\u673a\u5236\u5c06\u5904\u7406\u5668\u63a5\u5165\u5230\u4eff\u771f\u73af\u5883\uff0c\u5e76\u8bbf\u95ee\u4eff\u771f\u73af\u5883\u7684\u5185\u5b58\u3002</p> <p></p>"},{"location":"pipeline-cpu/#_10","title":"\u5bf9\u4e8e\u53d6\u6307\u9636\u6bb5","text":"<p>\u7531\u4e8e\u5185\u5b58\u662f\u4eff\u771f\u73af\u5883\u63d0\u4f9b\u7684\uff0c\u5f53\u6211\u4eec\u4ece\u5185\u5b58\u4e2d\u8fdb\u884c\u53d6\u6307\u65f6\uff0c\u9700\u8981\u901a\u8fc7DPI-C\u673a\u5236\u8bbf\u95ee\u5185\u5b58\uff0c\u4f7f\u7528\u65b9\u6cd5\u53c2\u8003\u4e0b\u5217\u4ee3\u7801 \u540c\u65f6\u9700\u8981\u5728\u53d6\u6307\u9636\u6bb5\u8ba9<code>commit</code>\u4fe1\u53f7\u4e3a<code>1'b1</code></p> <pre><code>module fetch(\n    //\u5176\u4ed6\u4fe1\u53f7\n);\n\nimport \"DPI-C\" function int  dpi_mem_read   (input int addr  , input int len);\nassign instr = dpi_mem_read(pc, 4);\nassign commit = 1'b1;\nendmodule\n\n</code></pre> <p></p>"},{"location":"pipeline-cpu/#_11","title":"\u5bf9\u4e8e\u5bc4\u5b58\u5668\u6587\u4ef6\u7684\u8bbf\u95ee","text":"<p>\u7531\u4e8e\u4eff\u771f\u73af\u5883\u5728\u8fdb\u884c\u6307\u4ee4\u9a8c\u8bc1\u7684\u65f6\u5019\uff0c\u9700\u8981\u83b7\u53d6\u5230\u5bc4\u5b58\u5668\u6587\u4ef6\u7684\u5185\u5b58\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u901a\u8fc7DPI-C\u673a\u5236\u5c06\u5bc4\u5b58\u5668\u6587\u4ef6\u4fe1\u53f7\u4f20\u9012\u7ed9\u4eff\u771f\u73af\u5883\uff0c\u4f7f\u7528\u65b9\u6cd5\u53c2\u8003\u4e0b\u5217\u4ee3\u7801</p> <pre><code>module regfile(\n    //\u5176\u4ed6\u4fe1\u53f7\n);\n\nreg [31:0] regfile[31:0];\nimport \"DPI-C\" function void dpi_read_regfile(input logic [31 : 0] a []);\ninitial begin\n    dpi_read_regfile(regfile);\nend\nendmodule\n</code></pre> <p></p>"},{"location":"pipeline-cpu/#_12","title":"\u5bf9\u4e8e\u5185\u5b58\u7684\u8bbf\u95ee","text":"<p>\u5f53\u5904\u7406\u5668\u9700\u8981\u8bfb\u5199\u5185\u5b58\u7684\u65f6\u5019\uff0c\u4e5f\u9700\u8981\u901a\u8fc7DPI-C\u673a\u5236\u4ece\u4eff\u771f\u73af\u5883\u83b7\u53d6\u5230\u5185\u5b58\u6570\u636e\uff0c\u4f7f\u7528\u65b9\u6cd5\u53c2\u8003\u4e0b\u5217\u4ee3\u7801</p> <pre><code>module memory(\n    //\u5176\u4ed6\u4fe1\u53f7\n);\n\nimport \"DPI-C\" function void dpi_mem_write(input int addr, input int data, int len);\nimport \"DPI-C\" function int  dpi_mem_read (input int addr  , input int len);\n\n//\u8bfb\u53d6\u5185\u5b58\uff0c\u6bcf\u6b21\u8bfb\u53d64\u4e2a\u5b57\u8282\uff0c\u7136\u540e\u6839\u636e\u9700\u8981\uff0c\u518d\u5bf9\u8bfb\u51fa\u6765\u7684\u6570\u636e\u8fdb\u884c\u5904\u7406\nwire \u4ece\u5185\u5b58\u4e2d\u8bfb\u51fa\u6765\u7684\u6570\u636e(32bit) = dpi_mem_read(\u8981\u8bfb\u53d6\u7684\u5185\u5b58\u5730\u5740, 4);\n\n//\u5199\u5165\nalways @(posedge clk) begin\n    if(\u5982\u679c\u8981\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u4e00\u4e2a\u5b57\u8282) begin\n        dpi_mem_write(\u5199\u5165\u5730\u5740, \u8981\u5199\u5165\u7684\u6570\u636e(32bit), 1);\n    end\n    else if(\u5982\u679c\u8981\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u4e24\u4e2a\u5b57\u8282) begin\n        dpi_mem_write(\u8981\u5199\u5165\u7684\u5730\u5740, \u8981\u5199\u5165\u7684\u6570\u636e(32bit), 2);        \n    end\n    else if(\u5982\u679c\u8981\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u56db\u4e2a\u5b57\u8282) begin\n        dpi_mem_write(\u8981\u5199\u5165\u7684\u5730\u5740, \u8981\u5199\u5165\u7684\u6570\u636e(32bit), 4);                \n    end\nend\n</code></pre> <p></p>"},{"location":"pipeline-cpu/#6-bubble","title":"6. \u6d41\u6c34\u7ebf\u5bc4\u5b58\u5668\u590d\u4f4d\u548c\u51b2\u5237<code>bubble</code>\u65f6\u7684\u5904\u7406","text":"<p>\u5f53\u5bf9\u6d41\u6c34\u7ebf\u5bc4\u5b58\u5668<code>regF</code>, <code>regD</code>, <code>regE</code>, <code>regM</code>, <code>regW</code>\u8fdb\u884c\u590d\u4f4d\u6216\u51b2\u5237\u65f6\uff0c\u9700\u8981\u5bf9\u6d41\u6c34\u7ebf\u5bc4\u5b58\u5668\u6709\u4e00\u4e2a\u521d\u59cb\u503c\uff0c\u521d\u59cb\u503c\u5efa\u8bae\u5982\u4e0b\uff1a</p> <p>\u5728\u5bf9\u6d41\u6c34\u7ebf\u5bc4\u5b58\u5668\u8fdb\u884c\u590d\u4f4d\u548c\u51b2\u5237<code>bubble</code>\u65f6\u7684\u5efa\u8bae\u4e3a<code>addi x0, x0, 0</code> \u5176\u5341\u516d\u8fdb\u5236\u4e3a<code>0x00000013</code>,\u4e8c\u8fdb\u5236\u4e3a<code>00000000000000000000000000010011</code> \u5176\u4e2d\u7684\u5404\u79cd\u63a7\u5236\u4fe1\u53f7\u548c\u6570\u636e\u4fe1\u53f7\uff0c\u5982<code>rs1</code>, <code>opcode</code>\u90fd\u662f\u4ece\u8fd9\u6761\u6307\u4ee4\u89e3\u7801\u8fc7\u6765\u7684</p> <p>\u5bf9\u6d41\u6c34\u7ebf\u5bc4\u5b58\u5668\u8fdb\u884c\u590d\u4f4d\u548c\u51b2\u5237<code>bubble</code>\u65f6\u7684\u4eff\u771f\u4fe1\u53f7\u5efa\u8bae\u5982\u4e0b</p> <pre><code>module regD\u6216\u8005regE\u6216\u8005regM\u6216\u8005regW(\n\n);\n\n    always @(posedge clk) begin\n        if(rst | bubble) begin\n            input_commit        &lt;= 1'd0;\n            input_commit_pc     &lt;= 32'd0;\n            input_commit_cur_pc &lt;= 32'd0;\n            input_commit_instr  &lt;= 32'd0;\n        end\n        else (~stall) begin\n            output_commit        &lt;= input_commit;\n            output_commit_pc     &lt;= input_commit_pc;\n            output_commit_cur_pc &lt;= input_commit_cur_pc;\n            output_commit_instr  &lt;= input_commit_instr;\n        end\n    end\nendmodule\n\n</code></pre>"},{"location":"pipeline-cpu/#_13","title":"\u4e03\u3001\u518d\u6b21\u8fd0\u884c\u9879\u76ee","text":"<p>\u5f53\u5c06\u5904\u7406\u5668\u6309\u7167\u6587\u6863\u8981\u6c42\u63a5\u5165\u5230\u4eff\u771f\u73af\u5883\u4ee5\u540e\uff0c\u6211\u4eec\u7684\u51c6\u5907\u5de5\u4f5c\u5c31\u4e00\u5207\u5c31\u7eea\u4e86\uff0c\u4e0b\u9762\u5c31\u8981\u5f00\u59cb\u5728\u8be5\u9879\u76ee\u6846\u67b6\u4e0b\u9a8c\u8bc1\u6211\u4eec\u81ea\u5df1\u7684\u5904\u7406\u5668\u4e86\u3002</p> <p>\u6267\u884c\u4e0b\u9762\u547d\u4ee4\uff0c\u518d\u6b21\u8fd0\u884c\u9879\u76ee</p> <pre><code>$ cd $SIM_HOME\n$ make run\n</code></pre> <p>\u5f53\u9879\u76ee\u8fd0\u884c\u6210\u529f\u540e\uff0c\u4f7f\u7528\u4e0a\u6587\u4e2d\u7684riscv\u5b98\u65b9\u6307\u4ee4\u6d4b\u8bd5\u96c6\u5373<code>riscv-tests-am</code>\u6765\u9a8c\u8bc1\u4f60\u7684\u5904\u7406\u5668\u5b9e\u73b0\u662f\u5426\u6b63\u786e</p>"},{"location":"pipeline-cpu/#_14","title":"\u516b\u3001[\u5931\u8d25\u8c03\u8bd5]\u5982\u4f55\u67e5\u770b\u548c\u9605\u8bfb\u6ce2\u5f62","text":"<p>\u5f53\u5904\u7406\u5668\u8fd0\u884c\u51fa\u73b0\u4e00\u4e2a\u7ea2\u8272\u7684<code>HIT BAD TRAP</code>\u5b57\u6837\u65f6\uff0c\u8bf4\u660e\u5904\u7406\u5668\u6267\u884c\u7684\u6307\u4ee4\u51fa\u9519\u3002 \u5f53\u6307\u4ee4\u51fa\u9519\u7684\u65f6\u5019\uff0c\u6211\u4eec\u9996\u5148\u53ef\u4ee5\u6839\u636eDifftest\u6253\u5370\u7684\u9519\u8bef\u4fe1\u606f\u6765\u8ffd\u8e2a\u9519\u8bef\u6307\u4ee4\uff0c\u5f53\u786e\u5b9a\u4e86\u9519\u8bef\u7684\u6307\u4ee4\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u67e5\u770b\u6ce2\u5f62\u6765\u6392\u67e5\u9519\u8bef\u3002</p>"},{"location":"pipeline-cpu/#1-difftest","title":"1. Difftest\u68c0\u6d4b\u548c\u6ce2\u5f62\u4fe1\u606f\u8bf4\u660e","text":"<p>\u5728\u5355\u5468\u671f\u5904\u7406\u4e2d\uff0c\u7531\u4e8e\u5904\u7406\u5668\u5728\u4e00\u4e2a\u5468\u671f\u53ea\u6267\u884c\u4e00\u6761\u6307\u4ee4\uff0c\u6240\u4ee5\u9519\u8bef\u6307\u4ee4\u88abDifftest\u6355\u6349\u65f6\uff0c\u4e00\u822c\u4e3a\u6ce2\u5f62\u6587\u4ef6\u7684\u6700\u540e\u4e00\u6761\u6307\u4ee4\u3002</p> <p>\u4e0d\u8fc7\u5728\u6d41\u6c34\u7ebf\u5904\u7406\u5668\u4e2d\uff0c\u5f53\u9519\u8bef\u6307\u4ee4\u8fdb\u884c\u5230\u5199\u56de\u9636\u6bb5\u5e76\u88abDifftest\u6355\u6349\u5230\u65f6\uff0c\u6b64\u65f6\u4eff\u771f\u6846\u67b6\u65e9\u5df2\u8ffd\u8e2a\u4e86\u51e0\u6761\u7ecf\u5386\u8fc7\u8bd1\u7801\u3001\u6267\u884c\u3001\u8bbf\u5b58\u6307\u4ee4\u3002 \u56e0\u6b64\u548c\u5355\u5468\u671f\u4e0d\u540c\uff0cDifftest\u6355\u6349\u7684\u51fa\u9519\u7684\u6307\u4ee4\u901a\u5e38\u4e0d\u662f\u6ce2\u5f62\u6587\u4ef6\u7684\u6700\u540e\u4e00\u6761\u6ce2\u5f62\uff0c\u800c\u662f\u6700\u540e\u4e00\u6761\u6ce2\u5f62\u524d\u97624-5\u4e2a<code>clk</code>\u7684\u6ce2\u5f62\u3002 \u7531\u4e8e\u6d41\u6c34\u7ebf\u4e2d\u6709Stall\u548cBubble\u7684\u5b58\u5728\uff0c\u5219\u4f1a\u4f7f\u5f97\u6ce2\u5f62\u6587\u4ef6\u66f4\u52a0\u590d\u6742, \u4e00\u822c\u771f\u6b63\u51fa\u9519\u7684\u6307\u4ee4\u4e3a\u6ce2\u5f62\u6587\u4ef6\u6700\u540e\u4e00\u6761\u6ce2\u5f62\u524d\u97624-20\u4e2a<code>clk</code>\u7684\u6ce2\u5f62\u3002</p> <p>\u4ee5\u4e0a\u662f\u9519\u8bef\u6307\u4ee4\u5728\u6ce2\u5f62\u6587\u4ef6\u7684\u5927\u6982\u4f4d\u7f6e\uff0c\u5177\u4f53\u662f\u54ea\u4e00\u6761\u6ce2\u5f62\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u901a\u8fc7<code>pc</code>\u548c<code>instr</code>\u8fdb\u884c\u51c6\u786e\u5b9a\u4f4d\u3002</p> <p>\u5bf9\u4e8eDifftest\u6355\u6349Store\u6307\u4ee4\u548cLoad\u6307\u4ee4\u51fa\u9519\u7684\u673a\u5236\uff0c\u548c\u5355\u5468\u671f\u5904\u7406\u5668\u7c7b\u4f3c\u3002</p>"},{"location":"pipeline-cpu/#2_2","title":"2. \u5982\u4f55\u67e5\u770b\u6ce2\u5f62","text":"<p>\u6bcf\u5f53\u6d4b\u8bd5\u7a0b\u5e8f\u6210\u529f\u8fd0\u884c\u5b8c\u6bd5\u5e76\u9000\u51fa\u540e\uff0c\u4eff\u771f\u6d4b\u8bd5\u6846\u67b6\u5c31\u4f1a\u5c06\u8be5\u6b21\u5904\u7406\u5668\u8fd0\u884c\u7684\u6ce2\u5f62\u4fe1\u606f\u4fdd\u5b58\u4e0b\u6765 \u6b64\u65f6\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff0c\u67e5\u770b\u6ce2\u5f62</p> <pre><code>cd $SIM_HOME &amp;&amp; make sim\n</code></pre>"},{"location":"pipeline-cpu/#3_1","title":"3. \u5982\u4f55\u9ad8\u6548\u67e5\u770b\u6ce2\u5f62","text":"<p><code>gtkwave</code>\u5728\u5de6\u4e0b\u89d2\u6709\u4e00\u4e2a\u4fe1\u53f7\u641c\u7d22\u6846\u53ef\u4ee5\u8fdb\u884c\u7b5b\u9009\uff0c\u53ef\u4ee5\u7b5b\u9009\u51fa\u81ea\u5df1\u60f3\u8981\u770b\u7684\u4fe1\u53f7\u6ce2\u5f62\u3002</p>"},{"location":"run-RT/","title":"{{ $frontmatter.title }}","text":""},{"location":"run-RT/#rt","title":"\u4e00\u3001\u53c2\u8003\u8bbe\u8ba1\u5904\u7406\u5668\u542f\u52a8RT","text":"<ol> <li>\u514b\u9686<code>RT</code>\u9879\u76ee</li> </ol> <p>\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u514b\u9686<code>RT</code></p> <pre><code>$ git clone git@github.com:cs-prj-repo/rt-thread-am.git\n</code></pre> <ol> <li>\u5c1d\u8bd5\u542f\u52a8<code>RT</code></li> </ol> <p>\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u5c1d\u8bd5\u542f\u52a8<code>RT</code>\u3002</p> <pre><code>cd xxx/rt-thread-am/bsp/abstract-machine\nmake clean\nmake init\nmake run ARCH=riscv32-npc\n</code></pre> <p>::: tip \u6ce8\u610f\u4e8b\u9879</p> <ol> <li> <p>\u5728\u542f\u52a8RT\u7684\u8fc7\u7a0b\u4e2d\u9700\u8981<code>\u5173\u95ed\u6ce2\u5f62</code>, <code>\u5173\u95ed\u6307\u4ee4\u8ffd\u8e2a</code>, <code>\u5173\u95edDifftest</code> \u5173\u95ed\u6307\u4ee4\u8ffd\u8e2a\u53ef\u4ee5\u6ce8\u91ca\u6389<code>sim.c</code>\u7684<code>IFDEF(CONFIG_ITRACE, instr_trace(cur_pc));</code>\u8fd9\u884c\u4ee3\u7801 \u5173\u95edDifftest\u53ef\u4ee5\u6ce8\u91ca\u6389<code>sim.c</code>\u7684<code>IFDEF(CONFIG_DIFFTEST, difftest_step(cur_pc, cur_pc + 4));</code>\u8fd9\u884c\u4ee3\u7801  </p> </li> <li> <p>\u6bcf\u6b21\u542f\u52a8<code>RT</code>\u90fd\u8981\u5b8c\u6574\u7684\u6267\u884c\u4ee5\u4e0a\u7684\u547d\u4ee4\uff0c\u5373\u6bcf\u6b21\u542f\u52a8<code>RT</code>\u90fd\u9700\u8981\u91cd\u65b0<code>make clean</code>, <code>make init</code>\u4e00\u6b21. ::: </p> </li> </ol>"},{"location":"run-RT/#_1","title":"\u4e8c\u3001\u5b8c\u5584\u4f60\u7684\u5355\u5468\u671f\u5904\u7406\u5668","text":"<p>\u5982\u679c\u4f60\u60f3\u8981\u8ba9\u4f60\u7684\u5355\u5468\u671f\u5904\u7406\u5668\u542f\u52a8<code>RT</code>\uff0c\u90a3\u4e48\u4f60\u7684\u5904\u7406\u5668\u9700\u8981\u5b9e\u73b0<code>mret</code>, <code>ecall</code>, <code>csrrw</code>, <code>csrrs</code>\u8fd9\u56db\u6761\u6307\u4ee4\uff0c\u5e76\u4e14\u652f\u6301\u8bfb\u5199<code>mstatus</code>, <code>mtvec</code>, <code>mcause</code>, <code>mepc</code>\u8fd9\u56db\u4e2aCSR\u5bc4\u5b58\u5668\u3002</p> <p>\u4ee5\u4e0b\u662f\u6307\u4ee4\u7684\u5b9e\u73b0\u65b9\u5f0f: \u5982\u679c\u662f<code>ecall</code>\u6307\u4ee4\uff0c \u90a3\u4e48\u5b83\u6307\u4ee4\u6548\u679c\u9700\u8981\u662f<code>mepc &lt;= pc + 4</code>\u5e76\u4e14<code>mcause &lt;= 32'd1</code></p> <p>\u4ee5\u4e0b\u662fCSR\u5bc4\u5b58\u5668\u7684\u5b9e\u73b0\u65b9\u5f0f:</p> <pre><code>reg [31:0] mstatus;\nreg [31:0] mtvec;\nreg [31:0] mepc;\nreg [31:0] mcause;\n\nalways @(posedge clk) begin\n    if(rst) begin\n        //CSR\u5bc4\u5b58\u5668\u7684\u521d\u59cb\u503c\n        mtvec   &lt;= 32'd0;\n        mstatus &lt;= 32'h1800;\n        mepc    &lt;= 32'd0;\n        mcause  &lt;= 32'd0; \n    end\n    else begin\n        //other code,\n    end\nend\n</code></pre> <p>::: tip \u5c0f\u63d0\u793a: \u8bfb\u5199CSR\u5bc4\u5b58\u5668\u65f6\u7684<code>csr_id</code> \u8bfb\u5199<code>mstatus</code>\u5bc4\u5b58\u5668\u7684<code>csr_id=300</code> \u8bfb\u5199<code>mtvec</code>\u5bc4\u5b58\u5668\u7684<code>csr_id=305</code> \u8bfb\u5199<code>mepc</code>\u5bc4\u5b58\u5668\u7684<code>csr_id=341</code> \u8bfb\u5199<code>mcause</code>\u5bc4\u5b58\u5668\u7684<code>csr_id=342</code> :::</p>"},{"location":"run-RT/#rt_1","title":"\u4e09\u3001\u4f7f\u7528\u4f60\u81ea\u5df1\u7684\u5904\u7406\u5668\u542f\u52a8<code>RT</code>","text":""},{"location":"single-cycle-cpu/","title":"{{ $frontmatter.title }}","text":"<p>::: tip \u6ce8\u610f\u4e8b\u9879\uff1a\u4f7f\u7528\u6700\u65b0\u7684\u9879\u76ee\u4ee3\u7801\u548c\u6587\u6863\uff01 \u9879\u76ee\u4f1a\u6301\u7eed\u4fee\u590d\u4e00\u4e9b\u9519\u8bef\u6216\u589e\u52a0\u4e00\u4e9b\u5bf9\u7528\u6237\u53cb\u597d\u7684\u5185\u5bb9\uff0c\u56e0\u6b64\u9879\u76ee\u548c\u6587\u6863\u4f1a\u6709\u4e0d\u95f4\u65ad\u7684\u66f4\u65b0\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u6700\u65b0\u7684\u9879\u76ee\u548c\u6587\u6863</p> <p>\u5173\u4e8e\u9879\u76ee\uff1a\u5982\u679c\u4f60\u5df2\u7ecf\u514b\u9686\u4e86\u9879\u76ee, \u53ef\u4ee5\u5728\u9879\u76ee\u76ee\u5f55\u4e0b\u4f7f\u7528<code>git pull</code>\u6765\u83b7\u53d6\u6700\u65b0\u7684\u9879\u76ee\u4ee3\u7801\u3002 \u5173\u4e8e\u6587\u6863\uff1a\u6587\u6863\u7684\u6700\u65b0\u7248\u672c\u4f1a\u76f4\u63a5\u5448\u73b0\u5728\u7f51\u9875\u4e0a\uff0c\u53ef\u4ee5\u591a\u7559\u610f\u7f51\u9875\u4e0a\u65b0\u589e\u4e86\u54ea\u4e9b\u5185\u5bb9</p> <p>\u6709\u5173<code>git pull</code>\u547d\u4ee4\u7684\u8be6\u7ec6\u4f7f\u7528\uff0c\u53ef\u4ee5\u901a\u8fc7AI\u6765\u83b7\u5f97\u66f4\u591a\u7684\u4fe1\u606f\u3002</p> <p>:::</p>"},{"location":"single-cycle-cpu/#_1","title":"\u4e00\u3001\u9879\u76ee\u4ecb\u7ecd","text":"<p>\u8be5\u9879\u76ee\u662f\u4e00\u4e2aRISC-V\u5355\u5468\u671f\u5904\u7406\u5668\u4eff\u771f\u3001\u6d4b\u8bd5\u6846\u67b6\u3002\u4f60\u53ef\u4ee5\u5c06\u4f60\u7684\u5355\u5468\u671f\u5904\u7406\u5668\u63a5\u5165\u5230\u8be5\u6846\u67b6\u4e2d\uff0c\u7528\u4e8e\u9a8c\u8bc1\u81ea\u5df1\u7684\u5904\u7406\u5668\u5b9e\u73b0\u662f\u5426\u6b63\u786e\uff0c\u4e5f\u53ef\u4ee5\u5728\u81ea\u5df1\u7684\u5904\u7406\u5668\u4e0a\u8fd0\u884c\u4e00\u4e9b\u7b80\u5355\u7684\u8f6f\u4ef6\u7a0b\u5e8f\u3002</p> <p>\u652f\u6301\u7684\u6307\u4ee4\u96c6:RV32IM</p> <p>\u9879\u76ee\u4e3b\u8981\u76ee\u5f55\u5982\u4e0b:</p> <pre><code>single-cycle-cpu\n\u251c\u2500\u2500 abstract-machine                 # \u88f8\u673a\u8fd0\u884c\u65f6\u73af\u5883(\u76ee\u524d\u5ffd\u7565\u5b83)\n\u251c\u2500\u2500 IP                               # \u5904\u7406\u5668\u4ee3\u7801\u76ee\u5f55\n\u2502    \u251c\u2500\u2500 mycpu                          # \u6b64\u76ee\u5f55\u7528\u4e8e\u63a5\u5165\u4f60\u7684\u5355\u5468\u671f\u5904\u7406\u5668\n\u2502    \u251c\u2500\u2500 single-cycle-cpu               # \u9879\u76ee\u5185\u7f6e\u7684\u4e00\u4e2a\u5355\u5468\u671f\u5904\u7406\u5668(verilog)\n\u2502    \u2514\u2500\u2500 single-cycle-cpu-master        # \u9879\u76ee\u5185\u7f6e\u7684\u4e00\u4e2a\u5355\u5468\u671f\u5904\u7406\u5668(verilog)\n\u251c\u2500\u2500 software-test                    # \u6d4b\u8bd5\u5904\u7406\u5668\u7684\u8f6f\u4ef6\u7a0b\u5e8f\n\u2502    \u251c\u2500\u2500 benchmarks                     # benchmark\u6d4b\u8bd5\u7a0b\u5e8f\n\u2502    \u2502   cpu-tests                      # \u7b80\u5355cpu\u6d4b\u8bd5\u7a0b\u5e8f\n\u251c\u2500\u2500 simulator                        # \u5904\u7406\u5668\u6a21\u62df\u4eff\u771f\u6846\u67b6\n\u2502    \u251c\u2500\u2500 include                        \n\u2502    \u2502   nemu                           # \u7528\u4e8edifftest\u7684nemu\u52a8\u6001\u94fe\u63a5\u5e93\u76ee\u5f55\n\u2502    \u2502   src                            # \u6e90\u4ee3\u7801\u76ee\u5f55\n\u2502    \u2514\u2500\u2500 Makefile                       \n\u251c\u2500\u2500 Makefile                         \n\u2514\u2500\u2500 README.md\n\n</code></pre>"},{"location":"single-cycle-cpu/#_2","title":"\u4e8c\u3001\u5b9e\u9a8c\u73af\u5883\u642d\u5efa","text":""},{"location":"single-cycle-cpu/#_3","title":"\u914d\u7f6e\u4e00\u89c8","text":"<ul> <li>\u64cd\u4f5c\u7cfb\u7edf\uff1a ubuntu 22.04(LTS), \u975eroot\u8d26\u6237</li> <li>\u4eff\u771f\u5de5\u5177\uff1a Verilator\u3001GTKwave</li> <li>\u7f16\u8bd1\u5de5\u5177\uff1a RISC-V</li> <li>\u7f16\u7a0b\u8bed\u8a00\uff1a Verilog HDL\u3001C\u8bed\u8a00</li> </ul>"},{"location":"single-cycle-cpu/#ubuntu","title":"\u5b89\u88c5ubuntu\u7cfb\u7edf","text":"<p>\u70b9\u51fb\u6b64\u5904\u67e5\u770b\u76f8\u5173\u8d44\u6599  ::: tip \u8bb0\u5f97\u66f4\u6362Ubuntu\u8f6f\u4ef6\u6e90</p> <p>\u7531\u4e8e Ubuntu \u9ed8\u8ba4\u8f6f\u4ef6\u6e90\u5728\u56fd\u5185\u8bbf\u95ee\u901f\u5ea6\u8f83\u6162\uff0c\u6211\u4eec\u5efa\u8bae\u5927\u5bb6\u66f4\u6362\u4e3a\u56fd\u5185\u7684\u8f6f\u4ef6\u6e90\uff0c\u4f8b\u5982\u5317\u5916\u955c\u50cf\u6e90\u3002</p> <p>\u5728\u66f4\u6362\u8f6f\u4ef6\u6e90\u540e\uff0c\u8bf7\u4f7f\u7528 sudo apt update \u547d\u4ee4\u66f4\u65b0\u7d22\u5f15\u3002 ::: </p>"},{"location":"single-cycle-cpu/#verilator","title":"\u5b89\u88c5Verilator","text":"<p>Verilator \u662f\u4e00\u6b3e\u5f00\u6e90\u7684\u652f\u6301 Verilog \u548c SystemVerilog \u4eff\u771f\u5de5\u5177\u3002\u5b83\u80fd\u591f\u5c06\u7ed9\u5b9a\u7684\u7535\u8def\u8bbe\u8ba1\u7ffb\u8bd1\u6210 C++ \u6216\u8005 SystemC \u7684\u5e93\u7b49\u4e2d\u95f4\u6587\u4ef6\uff0c\u6700\u540e\u4f7f\u7528 C/C++ \u7f16\u5199\u6fc0\u52b1\u6d4b\u8bd5\uff0c\u53bb\u8c03\u7528\u524d\u9762\u751f\u6210\u7684\u4e2d\u95f4\u6587\u4ef6\uff0c\u7531 C/C++ \u7f16\u8bd1\u5668\u7f16\u8bd1\u6267\u884c\uff0c\u6765\u5b8c\u6210\u4eff\u771f\u3002\u6b64\u5916\uff0c\u5b83\u4e5f\u5177\u6709\u9759\u6001\u4ee3\u7801\u5206\u6790\u7684\u529f\u80fd\u3002</p> <p>\u5982\u679c\u4f60\u60f3\u8981\u81ea\u5df1\u7f16\u8bd1\u5b89\u88c5Verilator, \u53ef\u4ee5\u53c2\u8003\u5b98\u65b9\u6587\u6863\u3001CSDN\u3001\u548c\u77e5\u4e4e\u3002\u672c\u6587\u4e3b\u8981\u5bf9\u6587\u6863\u5185\u5bb9\u8fdb\u884c\u6574\u7406\uff0c\u5e76\u8865\u5145\u4e00\u4e9b\u7ec6\u8282\u3002 \u4f60\u4e5f\u53ef\u4ee5\u6267\u884c\u4e0b\u5217\u547d\u4ee4\u76f4\u63a5\u5b89\u88c5verilator:</p> <pre><code>sudo apt install verilator\n</code></pre>"},{"location":"single-cycle-cpu/#gtkwave","title":"\u5b89\u88c5GTKwave","text":"<pre><code>$ sudo apt install gtkwave\n</code></pre>"},{"location":"single-cycle-cpu/#_4","title":"\u5b89\u88c5\u5e93\u6587\u4ef6\u548c\u7f16\u8bd1\u5de5\u5177","text":"<pre><code>$ sudo apt-get install build-essential\n$ sudo apt-get install libreadline-dev\n$ sudo apt-get install llvm-dev\n$ sudo apt-get install g++-riscv64-linux-gnu binutils-riscv64-linux-gnu\n</code></pre> <p>::: tip \u76ee\u524d\u4ecd\u6709\u4e00\u90e8\u5206\u5de5\u5177, \u6682\u672a\u63d0\u4f9b\u5b89\u88c5\u547d\u4ee4\uff0c\u540e\u7eed\u4f1a\u9646\u7eed\u6dfb\u52a0\u652f\u6301\u3002 ::: </p>"},{"location":"single-cycle-cpu/#_5","title":"single-cycle-cpu\u9879\u76ee\u4f7f\u7528\u6307\u5357","text":""},{"location":"single-cycle-cpu/#_6","title":"\u4e09\u3001\u521d\u6b21\u8fd0\u884c\u9879\u76ee","text":""},{"location":"single-cycle-cpu/#1","title":"1. \u83b7\u53d6\u9879\u76ee\u4ee3\u7801","text":"<p>\u5728\u547d\u4ee4\u884c\u6216\u7ec8\u7aef\u73af\u5883\u4e0b\uff0c\u6267\u884c\u4e0b\u5217\u547d\u4ee4\u83b7\u53d6\u9879\u76ee\u4ee3\u7801</p> <p>\u5982\u679c\u4e4b\u524d\u5df2\u7ecf\u6267\u884c\u8fc7\u4e0b\u9762\u4ee3\u7801\u514b\u9686\u8fc7\u8be5\u9879\u76ee\uff0c\u53ef\u4ee5\u5728\u9879\u76ee\u76ee\u5f55\u4e0b\u4f7f\u7528<code>git pull</code>\u6765\u83b7\u53d6\u6700\u65b0\u4ee3\u7801 \u6216\u8005\u4e5f\u53ef\u4ee5\u5c06\u5df2\u7ecf\u514b\u9686\u7684\u9879\u76ee\u5220\u9664\u6389\u4e4b\u540e\uff0c\u518d\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u3002 \u6709\u5173<code>git pull</code>\u7684\u4e00\u4e9b\u4f7f\u7528\u65b9\u6cd5\uff0c\u53ef\u4ee5\u901a\u8fc7\u8be2\u95ee<code>AI</code>\u5f97\u77e5</p> <pre><code>$ git clone git@github.com:cs-prj-repo/single-cycle-cpu.git\n</code></pre> <p>\u5982\u679c\u4f7f\u7528\u4e0a\u8ff0\u7684git\u514b\u9686\u5931\u8d25\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4</p> <pre><code>$ git clone https://github.com/cs-prj-repo/single-cycle-cpu.git\n</code></pre> <p>\u5982\u679c\u518d\u6b21\u514b\u9686\u5931\u8d25\u5e76\u4e14\u4f7f\u7528\u7684\u662f\u865a\u62df\u673a\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e0b\u8f7d\u538b\u7f29\u5305\u5e76\u4e14\u4f7f\u7528<code>scp</code>\u76f8\u5173\u547d\u4ee4\uff0c\u5c06\u6587\u4ef6\u62f7\u8d1d\u5230\u865a\u62df\u673a\u91cc\u9762\u3002</p>"},{"location":"single-cycle-cpu/#2","title":"2. \u8bbe\u7f6e\u73af\u5883\u53d8\u91cf","text":"<p>\u5728\u4f60\u7684<code>~/.bashrc</code>\u6587\u4ef6\u5f53\u4e2d\u6dfb\u52a0\u5982\u4e0b\u7684\u73af\u5883\u53d8\u91cf\uff0c\u6dfb\u52a0\u5b8c\u6210\u540e\uff0c\u6267\u884c<code>source ~/.bashrc</code>\u547d\u4ee4 \u6709\u5173\u5982\u4f55\u6dfb\u52a0\u73af\u5883\u53d8\u91cf\uff0c\u53ef\u4ee5\u901a\u8fc7\u8be2\u95ee<code>AI</code>\u5f97\u77e5</p> <pre><code>\nexport CPU_HOME=single-cycle-cpu\u76ee\u5f55\u7684\u7edd\u5bf9\u8def\u5f84 #\u590d\u5236\u540e\u8bb0\u5f97\u4fee\u6539,\u6ce8\u610f\u8bb0\u5f97\u662f\u7edd\u5bf9\u8def\u5f84\nexport SIM_HOME=$CPU_HOME/simulator          #\u76f4\u63a5\u590d\u5236\u5373\u53ef\nexport AM_HOME=$CPU_HOME/abstract-machine    #\u76f4\u63a5\u590d\u5236\u5373\u53ef\nexport TEST_HOME=$CPU_HOME/software-test     #\u76f4\u63a5\u590d\u5236\u5373\u53ef\n</code></pre>"},{"location":"single-cycle-cpu/#3","title":"3. \u8fd0\u884c\u9879\u76ee\u6846\u67b6\u9ed8\u8ba4\u7684\u5904\u7406\u5668\u548c\u5185\u7f6e\u7a0b\u5e8f","text":"<p>\u5728\u547d\u4ee4\u884c\u6216\u7ec8\u7aef\u73af\u5883\u4e0b\u6267\u884c\u4e0b\u9762\u547d\u4ee4\uff0c\u5c1d\u8bd5\u4f7f\u7528\u9879\u76ee\u6846\u67b6\u9ed8\u8ba4\u7684\u5904\u7406\u5668\u8fd0\u884c\u5185\u7f6e\u7a0b\u5e8f\u3002</p> <pre><code>$ cd $SIM_HOME\n$ make run\n</code></pre> <p>\u5982\u679c\u9879\u76ee\u8fd0\u884c\u540e\u51fa\u73b0\u4e00\u4e2a\u7eff\u8272\u7684<code>HIT GOOD TRAP</code>\uff0c\u8bf4\u660e\u7a0b\u5e8f\u8fd0\u884c\u6210\u529f\uff0c\u4e00\u5207\u6b63\u5e38\u3002</p> <p>\u5982\u679c\u9879\u76ee\u8fd0\u884c\u540e\u51fa\u73b0\u7f16\u8bd1\u62a5\u9519\uff0c\u8bf7\u81ea\u884c\u4fee\u590d\uff0c\u6216\u8054\u7cfb\u6211\u4eec\u5e76\u63d0\u4f9b\u62a5\u9519\u622a\u56fe\uff0c\u5e2e\u52a9\u6211\u4eec\u4fee\u590d\u9519\u8bef\u3002</p> <p>\u5982\u679c\u9879\u76ee\u8fd0\u884c\u540e\u51fa\u73b0\u4e00\u4e2a\u7ea2\u8272\u7684<code>HIG BAD TRAP</code>, \u8bf4\u660e\u5904\u7406\u5668\u6267\u884c\u6307\u4ee4\u65f6\u51fa\u9519\uff0c\u4e00\u822c\u662f\u5904\u7406\u5668\u5b9e\u73b0\u95ee\u9898\u3002</p> <p>::: tip \u9879\u76ee\u6846\u67b6\u7684\u4eff\u771f\u73af\u5883\u5bf9\u4e8e\u8bbf\u5b58\u7684\u8981\u6c42</p> <p>\u76ee\u524d\u9879\u76ee\u6846\u67b6\u652f\u6301\u7684\u5185\u5b58\u4e3a128MB, \u5730\u5740\u7a7a\u95f4\u4e3a[0x80000000, 0x8fffffff], \u6ce8\u610f\u5728\u8bbf\u5b58\u65f6\u4e0d\u8981\u8d85\u51fa\u8be5\u5730\u5740\u7a7a\u95f4\u8303\u56f4</p> <p>:::  ::: tip \u5904\u7406\u5668\u8fd0\u884c\u7684\u5185\u7f6e\u7a0b\u5e8f \u5f53\u5728<code>simluator</code>\u76ee\u5f55\u4e0b\u6267\u884c<code>make run</code>\u65f6\uff0c\u65e0\u8bba\u9879\u76ee\u6307\u5b9a\u54ea\u4e2a\u5904\u7406\u5668\u8fd0\u884c\uff0c\u90fd\u4f1a\u8fd0\u884c\u4e00\u4e2a\u5185\u7f6e\u7684\u7a0b\u5e8f \u8fd9\u6bb5\u5185\u7f6e\u7a0b\u5e8f\u6307\u4ee4\u5b58\u653e\u5728<code>simulator/src/monitor/monitor.c</code>\u6587\u4ef6\u4e0b\uff0c\u5176\u540d\u79f0\u4e3a<code>static const uint32_t img[]</code></p> <p>\u5728\u8fd0\u884c\u4f60\u7684\u5904\u7406\u5668\u7684\u65f6\u5019\uff0c\u4f60\u53ef\u4ee5\u6839\u636e\u81ea\u5df1\u7684\u9700\u8981\u6765\u4fee\u6539\u6b64\u5904\u4ee3\u7801\u6765\u8fd0\u884c\u6307\u5b9a\u7684\u7a0b\u5e8f\u6307\u4ee4</p> <p>\u6ce8\u610f\u5185\u7f6e\u7a0b\u5e8f\u6307\u4ee4\u4e00\u5b9a\u8981\u5305\u542b\u4e00\u6761<code>ebreak</code>\u6307\u4ee4 :::</p> <p>::: tip \u4eff\u771f\u73af\u5883\u5982\u4f55\u5224\u5b9a\u7a0b\u5e8f\u6267\u884c\u7ed3\u675f \u9879\u76ee\u6846\u67b6\u901a\u8fc7\u6307\u5b9a<code>ebreak</code>\u6307\u4ee4\u4e3a\u7a0b\u5e8f\u7ed3\u675f\u7684\u6307\u4ee4\u6765\u5224\u65ad\u4e00\u4e2a\u7a0b\u5e8f\u662f\u5426\u8fd0\u884c\u7ed3\u675f\u3002</p> <p>\u5728\u6267\u884c\u7a0b\u5e8f\u65f6\uff0c\u9879\u76ee\u6846\u67b6\u4f1a\u5728\u6bcf\u4e2a\u7a0b\u5e8f\u7684\u6700\u540e\u6ce8\u5165\u4e00\u6761<code>ebraek</code>\u6307\u4ee4\u6765\u8fbe\u5230\u8be5\u6548\u679c\u3002</p> <p>\u7531\u4e8e\u5185\u7f6e\u7a0b\u5e8f\u662f\u7528\u6237\u53ef\u4ee5\u81ea\u884c\u4fee\u6539\u7684\uff0c\u6240\u4ee5\u5185\u7f6e\u7a0b\u5e8f\u7684<code>ebreak</code>\u6307\u4ee4\u9700\u8981\u7531\u7528\u6237\u81ea\u5df1\u6dfb\u52a0\u3002 :::</p> <p>::: tip \u5f00\u542f/\u5173\u95edDifftest \u9879\u76ee\u9700\u8981\u4f7f\u7528DIfftest\u6280\u672f\u6765\u9a8c\u8bc1\u5904\u7406\u5668\u5b9e\u73b0\u662f\u5426\u6b63\u786e\u3002</p> <p>\u9879\u76ee\u4e2dDifftest\u9ed8\u8ba4\u5904\u4e8e\u5f00\u542f\u72b6\u6001</p> <p>\u5728<code>simulator/inlcude/utils/open_sim_difftest.h</code>\u6587\u4ef6\u4e2d \u53ef\u4ee5\u901a\u8fc7\u6ce8\u91ca\u6216\u8005\u89e3\u5f00\u6ce8\u91ca<code>#define CONFIG_DIFFTEST 1</code>\u6765\u6253\u5f00\u6216\u5173\u95edDifftest\u529f\u80fd</p> <p>\u6ce8\u610f\uff0c\u5f00\u542fDifftest\u4f1a\u51cf\u7f13\u7a0b\u5e8f\u8fd0\u884c\u65f6\u95f4\uff0c\u5728\u8fdb\u884cbenchmarck\u7a0b\u5e8f\u5bf9\u5904\u7406\u5668\u8fdb\u884c\u8dd1\u5206\u65f6\uff0c\u5efa\u8bae\u5173\u95edDifftest :::</p> <p>::: tip \u5f00\u542f/\u5173\u95ed\u6ce2\u5f62\u8ffd\u8e2a \u5728\u5904\u7406\u5668\u8fd0\u884c\u65f6\uff0c\u4eff\u771f\u6846\u67b6\u53ef\u4ee5\u8ffd\u8e2a\u5230\u5904\u7406\u5668\u8fd0\u884c\u7a0b\u5e8f\u7684\u6ce2\u5f62\u4fe1\u606f\u3002</p> <p>\u9879\u76ee\u9ed8\u8ba4\u6ce2\u5f62\u8ffd\u8e2a\u5904\u4e8e\u5173\u95ed\u72b6\u6001</p> <p>\u5728<code>simulator/inlcude/utils/open_sim_difftest.h</code>\u6587\u4ef6\u4e2d \u53ef\u4ee5\u901a\u8fc7\u6ce8\u91ca\u6216\u8005\u89e3\u5f00\u6ce8\u91ca<code>#define CONFIG_NPC_OPEN_SIM 1</code>\u6765\u6253\u5f00\u6216\u5173\u95ed\u6ce2\u5f62\u8ffd\u8e2a\u529f\u80fd</p> <p>\u8c28\u8bb0\uff0c\u5982\u679c\u5f00\u542f\u6ce2\u5f62\u8fd0\u884c\u5927\u578b\uff0c\u5219\u4f1a\u751f\u6210\u975e\u5e38\u5927\u7684\u6ce2\u5f62\u6587\u4ef6\uff0c\u9ad8\u8fbe1G-50GB\uff0c\u6709\u53ef\u80fd\u4f1a\u635f\u5bb3\u78c1\u76d8</p> <p>\u56e0\u6b64\uff0c\u5f53\u8fd0\u884c\u4e00\u4e9b\u5927\u578b\u7a0b\u5e8f\u65f6\uff0c\u6bd4\u5982benchmark\uff0c\u4e00\u5b9a\u4e0d\u8981\u5f00\u542f\u6ce2\u5f62\u8ffd\u8e2a\u3002</p> <p>\u5982\u4f55\u4f7f\u7528\u66f4\u5c0f\u7684\u6ce2\u5f62\u6587\u4ef6\u683c\u5f0f\uff0c\u5982fst\uff0c\u6b63\u5728\u5f00\u53d1\u4e2d\u3002 :::</p>"},{"location":"single-cycle-cpu/#4-riscv32","title":"4. \u4fee\u590driscv32\u7f16\u8bd1\u9519\u8bef","text":"<p>\u7b2c\u4e00\u6b21\u8fd0\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u4f1a\u51fa\u73b0\u4e00\u4e2a\u7f16\u8bd1\u9519\u8bef\uff0c\u6211\u4eec\u6765\u4fee\u590d\u5b83\u3002</p> <pre><code>$ cd $TEST_HOME/cpu-tests\n$ make run ARCH=riscv32-npc ALL=dummy\n</code></pre> <p>\u5982\u679c\u9047\u5230\u4e86\u4ee5\u4e0b\u9519\u8bef: <code>/usr/riscv64-linux-gnu/include/bits/wordsize.h:28:3: error: #error \"rv32i-based targets are not supported\"</code> \u90a3\u4e48\u4f7f\u7528<code>sudo</code>\u6743\u9650\u4fee\u6539<code>/usr/riscv64-linux-gnu/include/bits/wordsize.h</code>\u6587\u4ef6</p> <pre><code> #if __riscv_xlen == 64\n # define __WORDSIZE_TIME64_COMPAT32 1\n #else\n    # error \"rv32i-based targets are not supported\" -----&gt;\u5c06\u8fd9\u4e00\u884c\u6ce8\u91ca\u6389\n    # define __WORDSIZE_TIME64_COMPAT32 0           -----&gt;\u5728\u4e0b\u9762\u65b0\u589e\u8fd9\u4e00\u884c\n #endif\n</code></pre> <p>\u5982\u679c\u9047\u5230\u4e86\u4ee5\u4e0b\u9519\u8bef\uff1a <code>/usr/riscv64-linux-gnu/include/gnu/stubs.h:8:11: fatal error: gnu/stubs-ilp32.h: No such file or directory</code> \u90a3\u4e48\u4f7f\u7528<code>sudo</code>\u6743\u9650\u4fee\u6539<code>/usr/riscv64-linux-gnu/include/gnu/stubs.h</code>\u6587\u4ef6 \u5c06\u6587\u4ef6\u7684<code># include &lt;gnu/stubs-ilp32.h&gt;</code>\u8fd9\u6bb5\u4ee3\u7801\u6ce8\u91ca\u6389 </p> <p> </p>"},{"location":"single-cycle-cpu/#_7","title":"\u56db\u3001\u8fd0\u884c\u6d4b\u8bd5\u7a0b\u5e8f","text":"<p>\u4e0b\u9762\u63d0\u4f9b\u4e86\u591a\u4e2a\u53ef\u4ee5\u8fd0\u884c\u6d4b\u8bd5\u7a0b\u5e8f\u7684\u547d\u4ee4\uff0c\u9009\u62e9\u5176\u4e2d\u4e00\u90e8\u5206\u8fd0\u884c\u5373\u53ef</p> <p>::: tip \u8fd0\u884c\u7a0b\u5e8f\u5bf9\u5904\u7406\u5668\u7684\u8981\u6c42 \u7531\u4e8e\u6211\u4eec\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u662f\u53ef\u8fd0\u884c\u7684\u7a0b\u5e8f\uff0c\u4e00\u4e2a\u53ef\u8fd0\u884c\u7a0b\u5e8f\u8981\u6c42\u5904\u7406\u5668\u5fc5\u987b\u80fd\u591f\u6267\u884c<code>auipc</code>, <code>jal</code>,<code>addi</code>\u6307\u4ee4 ::: </p>"},{"location":"single-cycle-cpu/#riscv","title":"\u8fd0\u884criscv\u5b98\u65b9\u6307\u4ee4\u96c6\u6d4b\u8bd5\u96c6\u5408","text":"<p>\u5728\u9879\u76ee\u63d0\u4f9b\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u4e2d\uff0c\u5b98\u65b9\u6d4b\u8bd5\u96c6\u7a0b\u5e8f\u662f\u6700\u5b8c\u5907\u7684\u6d4b\u8bd5\u96c6\u7a0b\u5e8f\uff0c\u68c0\u6d4b\u51c6\u786e\u5ea6\u6700\u9ad8</p> <p>\u52a1\u5fc5\u4ee5\u8be5\u6d4b\u8bd5\u96c6\u7a0b\u5e8f\u4f5c\u4e3a\u5904\u7406\u5668\u6d4b\u8bd5\u662f\u5426\u901a\u8fc7\u7684\u6807\u51c6 1. \u514b\u9686riscv\u5b98\u65b9\u6307\u4ee4\u96c6\u6d4b\u8bd5\u4ed3\u5e93\uff0c\u53ef\u4ee5\u514b\u9686\u5230\u4efb\u610f\u76ee\u5f55</p> <pre><code>$ git clone git@github.com:cs-prj-repo/riscv-tests-am.git\n</code></pre> <ol> <li>\u8fd0\u884criscv\u5b98\u65b9\u6d4b\u8bd5\u96c6\u7a0b\u5e8f</li> </ol> <p>\u5728\u547d\u4ee4\u884c\u6216\u7ec8\u7aef\u4e0b\u6267\u884c\u4e0b\u9762\u7684\u4ee3\u7801\u8fd0\u884c\u6d4b\u8bd5\u96c6\u7a0b\u5e8f</p> <pre><code>#\u8fd0\u884criscv\u5b98\u65b9\u6307\u4ee4\u96c6\u6d4b\u8bd5\u7a0b\u5e8f\uff1a\ncd xxx/riscv-tests-am\nmake run ARCH=riscv32-npc ALL=\u60f3\u8981\u6d4b\u8bd5\u7684\u6307\u4ee4\n\n#\u793a\u4f8b1-\u6d4b\u8bd5add\u6307\u4ee4\u5b9e\u73b0\u662f\u5426\u6b63\u786e\uff1a\ncd xxx/riscv-tests-am\nmake run ARCH=riscv32-npc ALL=add\n\n#\u793a\u4f8b2-\u6d4b\u8bd5sub\u6307\u4ee4\u5b9e\u73b0\u662f\u5426\u6b63\u786e\ncd xxx/riscv-tests-am\nmake run ARCH=riscv32-npc ALL=sub\n\n#\u793a\u4f8b3-\u6d4b\u8bd5\u6240\u6709\u6307\u4ee4\u5b9e\u73b0\u662f\u5426\u6b63\u786e\ncd xxx/riscv-tests-am\nmake run ARCH=riscv32-npc\n</code></pre> <p> </p>"},{"location":"single-cycle-cpu/#cpu-tests","title":"\u8fd0\u884ccpu-tests\u76ee\u5f55\u4e0b\u7684\u6d4b\u8bd5\u96c6\u7a0b\u5e8f:","text":"<p>cpu-tests\u76ee\u5f55\u4e0b\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u53ea\u662f\u4e00\u4e9b\u7b80\u5355\u7684\u6d4b\u8bd5\u7a0b\u5e8f, \u6d4b\u8bd5\u51c6\u786e\u7387\u5e76\u4e0d\u9ad8</p> <p>cpu-tests\u76ee\u5f55\u4e0b\u7684\u6d4b\u8bd5\u7a0b\u5e8f\u91cc\u6709\u4e00\u4e9b\u542b\u6709M\u7c7b\u6307\u4ee4, \u5982\u679c\u4f60\u7684\u5904\u7406\u5668\u53ea\u652f\u6301RV32I\uff0c\u4f1a\u6709\u4e00\u4e9b\u6d4b\u8bd5\u65e0\u6cd5\u901a\u8fc7\uff0c\u8fd9\u662f\u6b63\u5e38\u7684\uff0c\u8bf7\u4e0d\u8981\u62c5\u5fc3\u3002</p> <p>\u5728\u547d\u4ee4\u884c\u6216\u7ec8\u7aef\u4e0b\u6267\u884c\u4e0b\u9762\u7684\u4ee3\u7801\u8fd0\u884c\u6d4b\u8bd5\u96c6\u7a0b\u5e8f</p> <pre><code>#\u8fd0\u884c\u6d4b\u8bd5\u96c6\u7a0b\u5e8f\u7684\u6846\u67b6\u4ee3\u7801\uff1a\ncd $TEST_HOME/cpu-tests\nmake run ARCH=riscv32-npc ALL=\u60f3\u8fd0\u884c\u7684\u7a0b\u5e8f\n\n#\u793a\u4f8b2-\u8fd0\u884cstring\u7a0b\u5e8f\uff1a\ncd $TEST_HOME/cpu-tests\nmake run ARCH=riscv32-npc ALL=dummy\n\n#\u793a\u4f8b1-\u8fd0\u884cdummy\u7a0b\u5e8f\uff1a\ncd $TEST_HOME/cpu-tests\nmake run ARCH=riscv32-npc ALL=dummy\n\n#\u793a\u4f8b3-\u8fd0\u884c\u6240\u6709\u7a0b\u5e8f\uff1a\ncd $TEST_HOME/cpu-tests\nmake run ARCH=riscv32-npc\n</code></pre> <p></p>"},{"location":"single-cycle-cpu/#benchmarks","title":"\u8fd0\u884cbenchmarks\u76ee\u5f55\u4e0b\u7684\u6d4b\u8bd5\u96c6\u7a0b\u5e8f:","text":"<p>::: tip \u8fd0\u884cbenchmarks\u4e0b\u9762\u6d4b\u8bd5\u7a0b\u5e8f\u65f6, \u6682\u65f6\u5148\u5173\u95ed<code>Difftest</code>\u548c<code>\u6ce2\u5f62\u8ffd\u8e2a</code>\u529f\u80fd :::</p> <p>\u5728\u547d\u4ee4\u884c\u6216\u7ec8\u7aef\u4e0b\u6267\u884c\u4e0b\u9762\u7684\u4ee3\u7801\u8fd0\u884c\u6d4b\u8bd5\u96c6\u7a0b\u5e8f:</p> <pre><code>#\u8fd0\u884ccoremark\u6d4b\u8bd5, \u81f3\u5c11\u9700\u8981\u8dd1\u4e24\u5206\u949f:\ncd $TEST_HOME/benchmarks/coremark\nmake run ARCH=riscv32-npc \n\n\n#\u8fd0\u884cdhrystone\u6d4b\u8bd5\uff1a\ncd $TEST_HOME/benchmarks/dhrystone\nmake run ARCH=riscv32-npc \n\n#\u8fd0\u884cmicrobench\u6d4b\u8bd51\uff1a\ncd $TEST_HOME/benchmarks/microbench\nmake run ARCH=riscv32-npc mainargs=test\n\n#\u8fd0\u884cmicrobench\u6d4b\u8bd52\uff1a\ncd $TEST_HOME/benchmarks/microbench\nmake run ARCH=riscv32-npc mainargs=train\n\n</code></pre> <p>::: tip \u5c0f\u603b\u7ed3 \u901a\u8fc7\u6267\u884c\u4ee5\u4e0a\u547d\u4ee4\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e0b\u9762\u7684\u89c4\u5f8b:</p> <p>\u5982\u679c\u6d4b\u8bd5\u7a0b\u5e8f\u96c6\u91cc\u9762\u6709\u591a\u4e2a\u6d4b\u8bd5\u7a0b\u5e8f \u6267\u884c<code>make run ARCH=riscv32-npc ALL=xxx</code>\u53ea\u4f1a\u8fd0\u884c\u4e00\u4e2a\u53eb\u505a<code>xxx</code>\u7684\u6d4b\u8bd5\u7a0b\u5e8f \u6267\u884c<code>make run ARCH=riscv32-npc</code> \u4f1a\u8fd0\u884c\u6240\u6709\u7a0b\u5e8f</p> <p>::: </p>"},{"location":"single-cycle-cpu/#csr","title":"\u8fd0\u884cCSR\u6307\u4ee4\u6d4b\u8bd5\u7a0b\u5e8f","text":"<p>::: tip CSR\u6d4b\u8bd5\u7a0b\u5e8f\u6ce8\u610f\u4e8b\u9879 CSR\u6d4b\u8bd5\u7a0b\u5e8f\u867d\u7136\u5df2\u7ecf\u79fb\u690d\uff0c\u4e0d\u8fc7\u4eff\u771f\u6846\u67b6\u6682\u65f6\u4e0d\u652f\u6301\u5176\u6d4b\u8bd5---\u5168\u529b\u5f00\u53d1\u4e2d ::: \u5f53\u4f60\u5b9e\u73b0\u4e86<code>mret</code>,<code>ecall</code>,<code>csrrw</code>, <code>csrrs</code>\u6307\u4ee4\u4e4b\u540e, \u53ef\u4ee5\u8fd0\u884c<code>yield-os</code>\u6d4b\u8bd5\u7a0b\u5e8f\u3002 \u5982\u679c\u5904\u7406\u5668\u5b9e\u73b0\u6b63\u786e\uff0c\u6d4b\u8bd5\u7a0b\u5e8f\u4f1a\u7f13\u6162\u51fa\u73b0\u5b57\u6bcd<code>ABABAB</code>\u7684\u5e8f\u5217\u3002 \u5982\u679c\u5904\u7406\u5668\u5b9e\u73b0\u51fa\u9519\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u4e0d\u662f\u90a3\u4e48\u7684\u597d\u8c03\u8bd5\uff0c\u56e0\u4e3a\u6d89\u53ca\u5230\u5404\u79cd\u9677\u5165\uff0c\u6bd4\u8f83\u590d\u6742---&gt;\u5f85\u6539\u8fdb</p> <p>\u6267\u884c\u4e0b\u5217\u547d\u4ee4\uff0c\u8fd0\u884c<code>yield-os</code>\u6d4b\u8bd5\u7a0b\u5e8f</p> <pre><code>cd $TEST_HOME/csr-tests/yield-os\nmake run ARCH=riscv32-npc\n</code></pre>"},{"location":"single-cycle-cpu/#_8","title":"\u4e94\u3001\u6307\u5b9a\u9879\u76ee\u8fd0\u884c\u4f60\u7684\u5904\u7406\u5668","text":"<p>\u9996\u5148\u5728<code>single-cycle-cpu/IP</code>\u76ee\u5f55\u4e0b\u9762\u65b0\u5efa\u4e00\u4e2a\u76ee\u5f55\uff0c\u76ee\u5f55\u7684\u540d\u79f0\u4e0d\u4f5c\u4efb\u4f55\u8981\u6c42\u3002 \u4e0b\u6587\u4f7f\u7528<code>your_cpu_dir</code>\u8fdb\u884c\u4ee3\u6307, \u5c06\u4f60\u7684\u5904\u7406\u5668\u4ee3\u7801\u5168\u90e8\u653e\u5230<code>your_cpu_dir</code>\u76ee\u5f55\u4e0b\u9762 \u6700\u540e\u518d\u901a\u8fc7simulator/Makefile\u4e2d\u7684<code>CPU_DIR</code>\u53d8\u91cf\u4e3a\u4f60\u7684\u5904\u7406\u5668\u76ee\u5f55\u8def\u5f84\uff0c\u6765\u6307\u5b9a\u9879\u76ee\u8fd0\u884c\u4f60\u7684\u5904\u7406\u5668</p> <p>::: warning \u6ce8\u610fdefine.v\u6587\u4ef6\u5fc5\u987b\u548c\u4f60\u7684\u5904\u7406\u5668\u540c\u5728\u4e00\u4e2a\u76ee\u5f55\u4e0b\u9762 :::</p> <p>::: tip \u793a\u4f8b</p> <p>\u9879\u76ee\u901a\u8fc7<code>simulator/Makefile</code>\u4e2d\u7684<code>CPU_DIR :=$(CPU_HOME)/IP/single-cycle</code>\u6307\u5b9a\u4e86\u9879\u76ee\u4f1a\u8fd0\u884c<code>single-cycle\u76ee\u5f55\u4e0b\u7684\u5904\u7406\u5668</code></p> <p>\u901a\u8fc7\u4fee\u6539<code>CPU_DIR :=$(CPU_HOME)/IP/\u4f60\u7684\u5904\u7406\u5668\u76ee\u5f55\u540d\u5b57</code>, \u53ef\u4ee5\u6307\u5b9a\u9879\u76ee\u8fd0\u884c<code>\u4f60\u7684\u5904\u7406\u5668</code></p> <p>\u793a\u4f8b\uff1a \u82e5<code>simulator/Makefile</code>\u4e2d\u7684<code>CPU_DIR :=$(CPU_HOME)/IP/AAA</code>, \u5219\u9879\u76ee\u4f1a\u8fd0\u884c<code>AAA</code>\u76ee\u5f55\u4e0b\u7684\u5904\u7406\u5668</p> <p>:::</p>"},{"location":"single-cycle-cpu/#_9","title":"\u516d\u3001\u5c06\u4f60\u7684\u5904\u7406\u5668\u63a5\u5165\u4eff\u771f\u73af\u5883","text":"<p>\u4e3a\u4e86\u652f\u6301\u6240\u6709\u7684\u5355\u5468\u671f\u5904\u7406\u5668\u90fd\u53ef\u4ee5\u63a5\u5165\u8be5\u4eff\u771f\u3001\u6d4b\u8bd5\u73af\u5883, \u4eff\u771f\u73af\u5883\u5bf9\u8fd0\u884c\u7684\u5904\u7406\u5668\u6709\u4e00\u5b9a\u7684\u8981\u6c42</p>"},{"location":"single-cycle-cpu/#1-top_module_name","title":"1. \u4eff\u771f\u6846\u67b6\u5bf9\u4e8e\u5904\u7406\u5668\u6700\u9876\u5c42\u6a21\u5757\u540d\u79f0<code>TOP_Module_Name</code>\u7684\u8981\u6c42","text":"<p>\u4e3a\u4e86\u652f\u6301\u6240\u6709\u7684\u5355\u5468\u671f\u5904\u7406\u5668\u90fd\u53ef\u4ee5\u63a5\u5165\u8be5\u4eff\u771f\u3001\u6d4b\u8bd5\u73af\u5883\uff0c\u6211\u4eec\u9884\u5148\u8bbe\u5b9a\u4e86\u4e00\u4e2a\u6700\u9876\u5c42\u7684\u4eff\u771f\u6a21\u5757\u540d\u79f0\uff0c\u5373<code>TOP_Module_Name=CPU</code>\u4e5f\u5c31\u662f\u8bf4\u5904\u7406\u5668\u6700\u9876\u5c42\u6a21\u5757\u540d\u79f0\u5fc5\u987b\u662f<code>CPU</code> ::: warning \u4eff\u771f\u6846\u67b6\u53ea\u5bf9TOP_Module_Name\u6709\u6b64\u8981\u6c42\uff0c\u5bf9\u6240\u6709\u7684verilog\u4ee3\u7801\u6587\u4ef6\u540d\uff0c\u5176\u4ed6\u6a21\u5757\u540d\u79f0\u5747\u6ca1\u6709\u4efb\u4f55\u8981\u6c42\u3002 :::</p> <p>::: tip \u81ea\u5b9a\u4e49\u4f60\u7684\u5904\u7406\u5668TOP_Module_Name</p> <p>\u9879\u76ee\u901a\u8fc7<code>simulator/Makefile</code>\u4e2d\u7684<code>TOPNAME :=CPU</code>\u6307\u5b9a\u4e86\u5904\u7406\u5668\u6700\u9876\u5c42\u6a21\u5757\u540d\u79f0<code>TOP_Module_Name</code>\u5fc5\u987b\u4e3a<code>CPU</code></p> <p>\u901a\u8fc7\u4fee\u6539<code>TOPNAME :=\u4f60\u5199\u7684\u6a21\u5757\u540d</code>, \u53ef\u4ee5\u6307\u5b9a\u5904\u7406\u5668\u6700\u9876\u5c42\u6a21\u5757\u540d\u79f0\u4e3a<code>\u4f60\u5199\u7684\u6a21\u5757\u540d</code></p> <p>\u793a\u4f8b\uff1a \u82e5<code>simulator/Makefile</code>\u4e2d\u7684<code>TOPNAME :=AAA</code>, \u5219\u5904\u7406\u5668\u6700\u9876\u5c42\u6a21\u5757\u540d\u79f0\u9700\u8981\u4e3a<code>AAA</code> :::  </p>"},{"location":"single-cycle-cpu/#2_1","title":"2. \u4eff\u771f\u6846\u67b6\u5bf9\u5904\u7406\u5668\u6700\u9876\u5c42\u6a21\u5757\u7684\u4fe1\u53f7\u8981\u6c42","text":"<p>\u65e0\u8bba\u5904\u7406\u5668\u9876\u5c42\u6a21\u5757\u7684\u6a21\u5757\u540d\u662f\u4ec0\u4e48\uff0c\u5b83\u90fd\u5fc5\u987b\u5e26\u6709\u4e0b\u9762\u4e09\u4e2a\u4fe1\u53f7<code>clk</code>, <code>rst</code>, <code>cur_pc_for_simulator</code> \u5982\u679c\u4f60\u5bf9\u4eff\u771f\u6846\u67b6\u6bd4\u8f83\u719f\u6089\uff0c</p> <pre><code>module TOP_Module_Name\n(\n    input  wire         clk,                    //\u8be5\u4fe1\u53f7\u662f\u4eff\u771f\u6846\u67b6\u63d0\u4f9b\u7684\u65f6\u949f\u4fe1\u53f7\n    input  wire         rst,                    //\u8be5\u4fe1\u53f7\u662f\u4eff\u771f\u6846\u67b6\u63d0\u4f9b\u7684\u590d\u4f4d\u4fe1\u53f7\n    output wire [31:0]  cur_pc_for_simulator    //\u8be5\u4fe1\u53f7\u9700\u8981\u8fde\u63a5\u5f53\u524d\u7684pc\u503c\n);\n\nendmodule\n</code></pre> <p></p>"},{"location":"single-cycle-cpu/#3-clkrst","title":"3. \u4eff\u771f\u6846\u67b6\u4e2d<code>clk</code>\u548c<code>rst</code>\u4fe1\u53f7\u7684\u4f7f\u7528\u8981\u6c42","text":"<p>\u4eff\u771f\u6846\u67b6<code>clk</code>\u548c<code>rst</code>\u4fe1\u53f7\u7684\u4f7f\u7528\u8981\u6c42\u5982\u4e0b\uff1a</p> <pre><code>//\u6211\u4eec\u53ea\u6355\u6349\u65f6\u949f\u4e0a\u5347\u6cbf\u7684\u4fe1\u53f7\u8fdb\u884c\u5904\u7406\uff0c\u793a\u4f8b\u5982\u4e0b\nalways @(posedge clk) begin\n\nend\n\n//rst\u5728\u9ad8\u7535\u5e73\u65f6\u8fdb\u884c\u590d\u4f4d\nalways @(posedge clk) begin\n    if(rst) begin        //\u9ad8\u7535\u5e73\u65f6\u8fdb\u884c\u590d\u4f4d\n        regfile[0] &lt;= 32'h0\n    end \n    else begin\n        //other code\n    end\nend\n\n</code></pre> <p></p>"},{"location":"single-cycle-cpu/#4-pc","title":"4. \u4eff\u771f\u6846\u67b6\u5bf9\u4e8epc\u590d\u4f4d\u503c\u7684\u8981\u6c42","text":"<p><code>pc</code>\u521d\u59cb\u590d\u4f4d\u503c\u5fc5\u987b\u4e3a<code>0x80000000</code></p> <pre><code>always @(posedge clk) begin\n    if(rst) begin\n        pc &lt;= 32'h80000000; //32\u4f4d\u64cd\u4f5c\u7cfb\u7edf\n    end\nend\n</code></pre> <p></p>"},{"location":"single-cycle-cpu/#5-dpi-c","title":"5. \u63a5\u5165\u4eff\u771f\u6846\u67b6\u7684DPI-C\u673a\u5236","text":"<p>\u6211\u4eec\u4f7f\u7528Verilator\u7684DPI-C\u673a\u5236\u5c06\u5904\u7406\u5668\u63a5\u5165\u5230\u4eff\u771f\u73af\u5883\uff0c\u5e76\u8bbf\u95ee\u4eff\u771f\u73af\u5883\u7684\u5185\u5b58\u3002</p> <p></p>"},{"location":"single-cycle-cpu/#_10","title":"\u5bf9\u4e8e\u53d6\u6307\u9636\u6bb5","text":"<p>\u7531\u4e8e\u5185\u5b58\u662f\u4eff\u771f\u73af\u5883\u63d0\u4f9b\u7684\uff0c\u5f53\u6211\u4eec\u4ece\u5185\u5b58\u4e2d\u8fdb\u884c\u53d6\u6307\u65f6\uff0c\u9700\u8981\u901a\u8fc7DPI-C\u673a\u5236\u8bbf\u95ee\u5185\u5b58\uff0c\u4f7f\u7528\u65b9\u6cd5\u53c2\u8003\u4e0b\u5217\u4ee3\u7801</p> <pre><code>module fetch(\n    //\u5176\u4ed6\u4fe1\u53f7\n);\n\nimport \"DPI-C\" function int  dpi_mem_read   (input int addr  , input int len);\nassign instr = dpi_mem_read(pc, 4);\nendmodule\n</code></pre> <p></p>"},{"location":"single-cycle-cpu/#_11","title":"\u5bf9\u4e8e\u5bc4\u5b58\u5668\u6587\u4ef6\u7684\u8bbf\u95ee","text":"<p>\u7531\u4e8e\u4eff\u771f\u73af\u5883\u5728\u8fdb\u884c\u6307\u4ee4\u9a8c\u8bc1\u7684\u65f6\u5019\uff0c\u9700\u8981\u83b7\u53d6\u5230\u5bc4\u5b58\u5668\u6587\u4ef6\u7684\u5185\u5b58\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u901a\u8fc7DPI-C\u673a\u5236\u5c06\u5bc4\u5b58\u5668\u6587\u4ef6\u4fe1\u53f7\u4f20\u9012\u7ed9\u4eff\u771f\u73af\u5883\uff0c\u4f7f\u7528\u65b9\u6cd5\u53c2\u8003\u4e0b\u5217\u4ee3\u7801</p> <pre><code>module regfile(\n    //\u5176\u4ed6\u4fe1\u53f7\n);\n\nreg [31:0] regfile[31:0];\nimport \"DPI-C\" function void dpi_read_regfile(input logic [31 : 0] a []);\ninitial begin\n    dpi_read_regfile(regfile);\nend\nendmodule\n</code></pre> <p></p>"},{"location":"single-cycle-cpu/#_12","title":"\u5bf9\u4e8e\u5185\u5b58\u7684\u8bbf\u95ee","text":"<p>\u5f53\u5904\u7406\u5668\u9700\u8981\u8bfb\u5199\u5185\u5b58\u7684\u65f6\u5019\uff0c\u4e5f\u9700\u8981\u901a\u8fc7DPI-C\u673a\u5236\u4ece\u4eff\u771f\u73af\u5883\u83b7\u53d6\u5230\u5185\u5b58\u6570\u636e\uff0c\u4f7f\u7528\u65b9\u6cd5\u53c2\u8003\u4e0b\u5217\u4ee3\u7801</p> <pre><code>module memory(\n    //\u5176\u4ed6\u4fe1\u53f7\n);\n\nimport \"DPI-C\" function void dpi_mem_write(input int addr, input int data, int len);\nimport \"DPI-C\" function int  dpi_mem_read (input int addr  , input int len);\n\n//\u8bfb\u53d6\u5185\u5b58\uff0c\u6bcf\u6b21\u8bfb\u53d64\u4e2a\u5b57\u8282\uff0c\u7136\u540e\u6839\u636e\u9700\u8981\uff0c\u518d\u5bf9\u8bfb\u51fa\u6765\u7684\u6570\u636e\u8fdb\u884c\u5904\u7406\nwire \u4ece\u5185\u5b58\u4e2d\u8bfb\u51fa\u6765\u7684\u6570\u636e(32bit) = dpi_mem_read(\u8981\u8bfb\u53d6\u7684\u5185\u5b58\u5730\u5740, 4);\n\n//\u5199\u5165\nalways @(posedge clk) begin\n    if(\u5982\u679c\u8981\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u4e00\u4e2a\u5b57\u8282) begin\n        dpi_mem_write(\u5199\u5165\u5730\u5740, \u8981\u5199\u5165\u7684\u6570\u636e(32bit), 1);\n    end\n    else if(\u5982\u679c\u8981\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u4e24\u4e2a\u5b57\u8282) begin\n        dpi_mem_write(\u8981\u5199\u5165\u7684\u5730\u5740, \u8981\u5199\u5165\u7684\u6570\u636e(32bit), 2);        \n    end\n    else if(\u5982\u679c\u8981\u4ece\u5185\u5b58\u4e2d\u8bfb\u53d6\u56db\u4e2a\u5b57\u8282) begin\n        dpi_mem_write(\u8981\u5199\u5165\u7684\u5730\u5740, \u8981\u5199\u5165\u7684\u6570\u636e(32bit), 4);                \n    end\nend\n</code></pre> <p></p>"},{"location":"single-cycle-cpu/#_13","title":"\u4e03\u3001\u518d\u6b21\u8fd0\u884c\u9879\u76ee","text":"<p>\u5f53\u5c06\u5904\u7406\u5668\u6309\u7167\u6587\u6863\u8981\u6c42\u63a5\u5165\u5230\u4eff\u771f\u73af\u5883\u4ee5\u540e\uff0c\u6211\u4eec\u7684\u51c6\u5907\u5de5\u4f5c\u5c31\u4e00\u5207\u5c31\u7eea\u4e86\uff0c\u4e0b\u9762\u5c31\u8981\u5f00\u59cb\u5728\u8be5\u9879\u76ee\u6846\u67b6\u4e0b\u9a8c\u8bc1\u6211\u4eec\u81ea\u5df1\u7684\u5904\u7406\u5668\u4e86\u3002</p> <p>\u6267\u884c\u4e0b\u9762\u547d\u4ee4\uff0c\u518d\u6b21\u8fd0\u884c\u9879\u76ee</p> <pre><code>$ cd $SIM_HOME\n$ make run\n</code></pre> <p>\u5f53\u9879\u76ee\u8fd0\u884c\u6210\u529f\u540e\uff0c\u4f7f\u7528\u4e0a\u6587\u4e2d\u7684riscv\u5b98\u65b9\u6307\u4ee4\u6d4b\u8bd5\u96c6\u5373<code>riscv-tests-am</code>\u6765\u9a8c\u8bc1\u4f60\u7684\u5904\u7406\u5668\u5b9e\u73b0\u662f\u5426\u6b63\u786e</p>"},{"location":"single-cycle-cpu/#_14","title":"\u516b\u3001[\u5931\u8d25\u8c03\u8bd5]\u5982\u4f55\u67e5\u770b\u548c\u9605\u8bfb\u6ce2\u5f62","text":"<p>\u5f53\u5904\u7406\u5668\u8fd0\u884c\u51fa\u73b0\u4e00\u4e2a\u7ea2\u8272\u7684<code>HIT BAD TRAP</code>\u5b57\u6837\u65f6\uff0c\u8bf4\u660e\u5904\u7406\u5668\u6267\u884c\u7684\u6307\u4ee4\u51fa\u9519\u3002 \u5f53\u6307\u4ee4\u51fa\u9519\u7684\u65f6\u5019\uff0c\u6211\u4eec\u9996\u5148\u53ef\u4ee5\u6839\u636eDifftest\u6253\u5370\u7684\u9519\u8bef\u4fe1\u606f\u6765\u8ffd\u8e2a\u9519\u8bef\u6307\u4ee4\uff0c\u5f53\u786e\u5b9a\u4e86\u9519\u8bef\u7684\u6307\u4ee4\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u67e5\u770b\u6ce2\u5f62\u6765\u6392\u67e5\u9519\u8bef\u3002</p>"},{"location":"single-cycle-cpu/#1-difftest","title":"1. Difftest\u68c0\u6d4b\u548c\u6ce2\u5f62\u4fe1\u606f\u8bf4\u660e","text":"<p>\u6211\u4eec\u4f7f\u7528\u7684Difftest\u662f\u5728\u6bcf\u4e00\u6761\u6307\u4ee4\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u5bf9\u6bd4\u4e00\u4e2a<code>\u53c2\u8003\u5904\u7406\u5668</code>\u548c<code>\u4f60\u7684\u5904\u7406\u5668</code>\u7684\u5bc4\u5b58\u5668\u548c<code>PC</code>\u72b6\u6001\u4fe1\u606f\u3002</p> <p>\u7531\u4e8e\u5927\u591a\u6570\u6307\u4ee4\u90fd\u4f1a\u4fee\u6539\u5bc4\u5b58\u5668\u548cPC\u7684\u72b6\u6001\uff0c\u6240\u4ee5\u5f53\u8fd9\u6837\u7684\u4e00\u6761\u6267\u884c\u5b8c\u6bd5\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7acb\u5373\u6bd4\u5bf9\u4ed6\u4eec\u7684\u5bc4\u5b58\u5668\u548cPC\u72b6\u6001\u4fe1\u606f\uff0c\u5982\u679c\u53d1\u73b0\u5904\u7406\u5668\u5b9e\u73b0\u51fa\u9519\uff0c\u90a3\u4e48\u7acb\u523b\u5c31\u53ef\u4ee5\u6355\u6349\u5230\u8fd9\u6837\u7684\u9519\u8bef\u3002</p> <p>\u4e00\u4e2a\u4f8b\u5916\u662fLoad\u548cStore\u6307\u4ee4\u3002 Store\u6307\u4ee4\u662f\u5c06\u5bc4\u5b58\u5668\u7684\u6570\u636e\u5199\u5165\u5230\u5185\u5b58\u4e2d\uff0c\u5e76\u4e0d\u4f1a\u66f4\u6539\u5bc4\u5b58\u5668\u7684\u72b6\u6001\uff0c\u6240\u4ee5Difftest\u65e0\u6cd5\u4e0d\u4f1a\u5bf9Store\u6307\u4ee4\u8fdb\u884c\u68c0\u6d4b\u3002 Load\u6307\u4ee4\u662f\u5c06\u5185\u5b58\u91cc\u9762\u7684\u6570\u636e\u8bfb\u53d6\u5230\u5bc4\u5b58\u5668\u4e2d\uff0c\u5f53\u5b83\u53d1\u751f\u9519\u8bef\u65f6\uff0c\u6709\u53ef\u80fd\u4e0d\u662fLoad\u6307\u4ee4\u81ea\u8eab\u7684\u95ee\u9898\uff0c\u800c\u662fStore\u6307\u4ee4\u51fa\u4e86\u9519\u3002 \u6309\u7167\u5927\u591a\u6570\u7a0b\u5e8f\u6267\u884c\u65f6\u7684\u7279\u6027\uff0c\u5b58\u5230\u5185\u5b58\u91cc\u9762\u7684\u6570\u636e\u4f1a\u5f88\u5feb\u4f1a\u88ab\u6307\u4ee4\u53d6\u51fa\u6765\u4f7f\u7528\uff0c\u5982\u679c\u5728Load\u6307\u4ee4\u5c06\u6570\u636e\u4ece\u5185\u5b58\u91cc\u9762\u53d6\u5230\u5bc4\u5b58\u5668\u65f6\u51fa\u73b0\u9519\u8bef\uff0c\u90a3\u4e48\u53ef\u4ee5\u63a8\u6d4b\u662fLoad\u6216Store\u6307\u4ee4\u51fa\u9519\u3002</p> <p>\u4f9d\u636eDifftest\u7684\u673a\u5236\uff0c\u5f53Difftest\u6355\u6349\u5230\u9519\u8bef\u7684\u65f6\u5019\uff0c\u6211\u4eec\u7ed3\u675f\u7a0b\u5e8f\u7684\u6ce2\u5f62\u8ffd\u8e2a\uff0c\u6b64\u65f6\u6ce2\u5f62\u6587\u4ef6\u7684\u6700\u540e\u4e00\u6761\u6ce2\u5f62\u5c31\u662fDIfftest\u51fa\u9519\u7684\u90a3\u6761\u6307\u4ee4\u3002 \u5bf9\u4e8e\u975eLoad\u548c\u975eStore\u6307\u4ee4\u6765\u8bf4\uff0c\u6ce2\u5f62\u6587\u4ef6\u7684\u6700\u540e\u4e00\u6761\u6ce2\u5f62\u5c31\u662f\u51fa\u9519\u7684\u90a3\u6761\u6307\u4ee4 \u5bf9\u4e8eLoad\u6307\u4ee4\u6765\u8bf4\uff0c\u6709\u53ef\u80fd\u4e0d\u662fLoad\u6307\u4ee4\u51fa\u9519\uff0c\u800c\u662fStore\u6307\u4ee4\u51fa\u9519\u3002\u5982\u679c\u662fStore\u6307\u4ee4\u7684\u9519\u8bef\uff0c\u9700\u8981\u53bb\u770b\u6700\u540e\u4e00\u6761\u6ce2\u5f62\u7684\u524d\u4e00\u4e9b\u5468\u671f\uff0c\u5373Store\u6307\u4ee4\u7684\u6ce2\u5f62\u3002</p> <p>::: tip Diffetst\u548c\u6ce2\u5f62\u6587\u4ef6\u603b\u7ed3 \u5bf9\u4e8e\u975eLoad\u548c\u975eStore\u6307\u4ee4\u6765\u8bf4\uff0c\u6ce2\u5f62\u6587\u4ef6\u7684\u6700\u540e\u4e00\u6761\u6ce2\u5f62\u5c31\u662f\u51fa\u9519\u7684\u90a3\u6761\u6307\u4ee4</p> <p>\u5bf9\u4e8eLoad\u6307\u4ee4\u6765\u8bf4\uff0c\u6709\u53ef\u80fd\u4e0d\u662fLoad\u6307\u4ee4\u51fa\u9519\uff0c\u800c\u662fStore\u6307\u4ee4\u51fa\u9519\u3002\u5982\u679c\u662fStore\u6307\u4ee4\u7684\u9519\u8bef\uff0c\u9700\u8981\u53bb\u770b\u6ce2\u5f62\u6587\u4ef6\u6700\u540e\u4e00\u6761\u6ce2\u5f62\u7684\u524d\u4e00\u4e9b\u5468\u671f\u7684Store\u6307\u4ee4\u7684\u6ce2\u5f62\u3002</p> <p>\u4ee5\u4e0a\u662f\u9519\u8bef\u6307\u4ee4\u5728\u6ce2\u5f62\u6587\u4ef6\u7684\u5927\u6982\u4f4d\u7f6e\uff0c\u5177\u4f53\u662f\u54ea\u4e00\u6761\u6ce2\u5f62\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u901a\u8fc7<code>pc</code>\u548c<code>instr</code>\u8fdb\u884c\u7cbe\u786e\u5b9a\u4f4d\u3002 :::</p>"},{"location":"single-cycle-cpu/#2_2","title":"2. \u5982\u4f55\u67e5\u770b\u6ce2\u5f62","text":"<p>\u6bcf\u5f53\u6d4b\u8bd5\u7a0b\u5e8f\u6210\u529f\u8fd0\u884c\u5b8c\u6bd5\u5e76\u9000\u51fa\u540e\uff0c\u4eff\u771f\u6d4b\u8bd5\u6846\u67b6\u5c31\u4f1a\u5c06\u8be5\u6b21\u5904\u7406\u5668\u8fd0\u884c\u7684\u6ce2\u5f62\u4fe1\u606f\u4fdd\u5b58\u4e0b\u6765 \u6b64\u65f6\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff0c\u67e5\u770b\u6ce2\u5f62</p> <pre><code>cd $SIM_HOME &amp;&amp; make sim\n</code></pre>"},{"location":"single-cycle-cpu/#3_1","title":"3. \u5982\u4f55\u9ad8\u6548\u67e5\u770b\u6ce2\u5f62","text":"<p><code>gtkwave</code>\u5728\u5de6\u4e0b\u89d2\u6709\u4e00\u4e2a\u4fe1\u53f7\u641c\u7d22\u6846\u53ef\u4ee5\u8fdb\u884c\u7b5b\u9009\uff0c\u53ef\u4ee5\u7b5b\u9009\u51fa\u81ea\u5df1\u60f3\u8981\u770b\u7684\u4fe1\u53f7\u6ce2\u5f62\u3002</p>"},{"location":"todo-list/","title":"todo-list\u9879\u76ee\u4f7f\u7528\u6307\u5357","text":"<ol> <li> <p>\u6700\u7ec8\u7684\u76ee\u6807 \u80fd\u542f\u52a8Linux\u7684\u5904\u7406\u5668\u4eff\u771f\u3001\u9a8c\u8bc1\u6846\u67b6\uff0c \u7136\u540e\u80fd\u4e0a\u677fFPGA</p> </li> <li> <p>todo-list</p> </li> </ol> <p>\u6ce2\u5f62\u8054\u8c03modelsim \u6ce2\u5f62\u53ef\u89c6\u5316 cache, AXI\u603b\u7ebf,SOC</p> <ol> <li> <p>riscv\u6a21\u62df\u5668\u542f\u52a8linux</p> </li> <li> <p>\u4e00\u4e2a\u80fd\u591f\u542f\u52a8linux\u7684\u5904\u7406\u5668\u6838(\u5e26MMU\uff0cTLB\uff0ccache), verilog</p> </li> </ol>"},{"location":"use-vscode/","title":"vscode","text":""},{"location":"use-vscode/#cc","title":"C/C++\u9879\u76ee\u5f00\u53d1\u63d2\u4ef6","text":"<ol> <li>C/C++\u63d2\u4ef6</li> <li>clangd\u63d2\u4ef6(\u5f3a\u70c8\u63a8\u8350\uff09\uff0c\u5982\u679c\u662fMakefile\u4f7f\u7528bear --make\u547d\u4ee4</li> </ol>"},{"location":"use-vscode/#verilog-hdl","title":"Verilog HDL\u9879\u76ee\u5f00\u53d1\u63d2\u4ef6","text":"<ol> <li>Digital IDE</li> <li>emacs verilog-mode\uff08\u6682\u65f6\u6ca1\u7528\u8fc7\uff09</li> <li>vscode-verilog-hdl-support(\u522b\u4eba\u63a8\u8350)</li> <li>Verilog Hdl Format</li> </ol>"},{"location":"use-vscode/#_1","title":"vscode","text":""},{"location":"vmware/","title":"windows\u4e0b\u4f7f\u7528\u865a\u62df\u673a","text":"<p>windows\u4e2d\u4f7f\u7528Terminal\u5b8c\u5584</p>"},{"location":"write-code-and-debug/","title":"write-code","text":"<p>\u8f6f\u4ef6\u4ee3\u7801\u548c\u786c\u4ef6\u4ee3\u7801\uff0c\u90fd\u662f\u5199\u5b8c\u4e86\u6d4b\u6b63\u786e\uff0c\u6162\u6162\u5b8c\u5584\u7684\u3002 \u57fa\u672c\u4e0a\u7b2c\u4e00\u5f00\u59cb\u5199\u7684\u65f6\u5019\uff0c\u5199\u7684\u90fd\u662f\u9519\u8bef\u7684\u4ee3\u7801\uff0c\u90fd\u662f\u901a\u8fc7\u4e00\u4e9b\u9519\u8bef\u8fdb\u884c\u53cd\u9988\uff0c\u6765\u6162\u6162\u5b8c\u5584\u3002</p> <p>\u4ee3\u7801\u4e0d\u662f\u5199\u6b63\u786e\u7684\uff0c\u662f\u6d4b\u8bd5\u6b63\u786e\u7684\u3002 \u4e0d\u53ef\u80fd\u4e00\u5f00\u59cb\u5c31\u5199\u7684\u5b8c\u5168\u6b63\u786e\u7684\u3002</p>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/","title":"\u6280\u672f\u6846\u67b6\u6587\u6863","text":""},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#_2","title":"\u89c2\u524d\u63d0\u9192","text":"<ol> <li> <p>\u4ed3\u5e93\u6258\u7ba1\u548c\u7f51\u9875\u6587\u6863page</p> </li> <li> <p>gitee\u7684gitee page\u529f\u80fd\u957f\u4e45\u4e0d\u5f00\u653e\uff0c\u65e0\u6cd5\u628a\u7f51\u9875\u6587\u6863\u653e\u5230gitee\u4e2d</p> </li> <li> <p>github\u7684\u63d0\u4f9b\u514d\u8d39\u7684github page\uff0c\u4f46\u662f\u9700\u8981\u628a\u4ed3\u5e93\u516c\u5f00\uff0c\u6709\u4fe1\u606f\u6cc4\u9732\u548c\u9690\u79c1\u6027\u7684\u98ce\u9669\u3002</p> <p>\u4ed8\u8d39\u7684github page\u53ef\u4ee5\u5c06\u4ed3\u5e93\u79c1\u6709\uff0c\u4e0d\u8fc7\u4ed8\u8d39\u7684\u65f6\u5019\u9700\u8981\u4f7f\u7528\u56fd\u9645\u94f6\u884c\u5361\u3002</p> </li> <li> <p>gitlab\u7684\u4ed3\u5e93\u6258\u7ba1\u548c\u514d\u8d39\u7f51\u9875\u529f\u80fd\uff0c\u9700\u8981\u4ed8\u8d39\u3002</p> </li> <li> <p>\u6d4b\u8bd5\u6846\u67b6\u9879\u76ee\u4ed3\u5e93\u6c47\u603b</p> </li> </ol>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#_3","title":"\u4e00\u3001\u9879\u76ee\u4ecb\u7ecd","text":"<p>\u8be5\u9879\u76ee\u662f\u4e00\u4e2a\u5bf9\u5904\u7406\u5668\u8fdb\u884c\u6d4b\u8bd5\u548c\u9a8c\u8bc1\u7684\u6846\u67b6\uff08\u540e\u7edf\u79f0\u4e3a\u6d4b\u8bd5\u6846\u67b6\uff09\uff0c\u4ee5\u4fbf\u4e8e\u7528\u6237\u5bf9\u5904\u7406\u5668\u8fdb\u884c\u5feb\u901f\u5f00\u53d1\u548c\u9a8c\u8bc1\u3002</p> <p>\u76ee\u524d\u6d4b\u8bd5\u6846\u67b6\u80fd\u591f\u5bf9\u9759\u6001\u5355\u53d1\u5c04\u4e94\u7ea7\u6d41\u6c34\u7ebf+ICache+\u5206\u652f\u9884\u6d4b\u7684\u5904\u7406\u5668\u8fdb\u884c\u6d4b\u8bd5\u548c\u9a8c\u8bc1\u3002</p> <p>\u6d4b\u8bd5\u6846\u67b6\u7684\u6838\u5fc3\u70b9\u662f\u4f7f\u7528\u5dee\u5206\u6d4b\u8bd5(Difftest)\u6280\u672f\u5bf9\u5904\u7406\u5668\u8fdb\u884c\u6d4b\u8bd5\u548c\u9a8c\u8bc1\uff0cDifftest\u7684\u601d\u60f3\u662f\u8ba9\u4e00\u4e2a\u767e\u5206\u767e\u6b63\u786e\u7684\u5904\u7406\u5668\u548c\u6211\u4eec\u81ea\u5df1\u5f00\u53d1\u7684\u5904\u7406\u5668\u8fdb\u884c\u5bf9\u6bd4\uff0c\u6bcf\u6b21\u8ba9\u4e24\u8005\u540c\u65f6\u6267\u884c\u4e00\u6761\u76f8\u540c\u7684\u6307\u4ee4\uff0c\u6267\u884c\u5b8c\u8fd9\u6761\u6307\u4ee4\u540e\u5bf9\u6bd4\u4e24\u4e2a\u5904\u7406\u5668\u7684\u5bc4\u5b58\u5668\u72b6\u6001\uff0c\u5982\u679c\u53d1\u73b0\u4e24\u8005\u7684\u5bc4\u5b58\u5668\u72b6\u6001\u4e0d\u4e00\u81f4\uff0c\u90a3\u4e48\u8bf4\u660e\u6211\u4eec\u7684\u5904\u7406\u5668\u5b9e\u73b0\u6709\u8bef\uff0c\u6b64\u65f6\u53ef\u4ee5\u5feb\u901f\u6ce2\u6349\u5230\u51fa\u9519\u7684\u662f\u54ea\u4e00\u6761\u6307\u4ee4\u3002\u5728\u6280\u672f\u5b9e\u73b0\u4e0a\uff0c\u6d4b\u8bd5\u6846\u67b6\u4f7f\u7528\u5904\u7406\u5668\u6a21\u62df\u5668(Spike/QEMU/NEMU)\u6765\u4ee3\u66ff\u8fd9\u4e2a\u767e\u5206\u767e\u5b8c\u5168\u6b63\u786e\u7684\u5904\u7406\u5668\u3002</p> <p>\u4ee5\u4e0b\u662f\u5904\u7406\u5668\u6d4b\u8bd5\u9a8c\u8bc1\u6d41\u7a0b\u7684\u5b9e\u4f8b\u4ee3\u7801</p> <pre><code>while(1){\n    ref_cpu_exec(1); //\u5b8c\u5168\u6b63\u786e\u7684\u5904\u7406\u5668(\u6a21\u62df\u5668)\u6267\u884c\u4e00\u6761\u6307\u4ee4\n    our_cpu_exec(1); //\u6211\u4eec\u7684\u5904\u7406\u5668\u6267\u884c\u4e00\u6761\u6307\u4ee4\n    diff_register(); //\u6bd4\u5bf9\u4e24\u4e2a\u5904\u7406\u5668\u7684\u5bc4\u5b58\u5668\u72b6\u6001 \n}\n</code></pre>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#_4","title":"\u4e8c\u3001\u6d4b\u8bd5\u6846\u67b6\u8be6\u60c5","text":""},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#1","title":"1. \u6d4b\u8bd5\u6846\u67b6\u6280\u672f\u4ecb\u7ecd","text":"<p>\u6d4b\u8bd5\u6846\u67b6\u901a\u8fc7\u4f7f\u7528veriltor\u5c06\u5904\u7406\u5668\u4ee3\u7801\u8f6c\u6362\u6210C/C++\u4ee3\u7801\uff0c\u4ece\u800c\u5904\u7406\u5668\u5f00\u53d1\u548c\u9a8c\u8bc1\u66f4\u6362\u5230\u4e86\u8f6f\u4ef6\u5c42\u9762\u3002</p> <p>\u5176\u6b21\u4f7f\u7528\u6a21\u62df\u5668(Spike/QEMU/NEMU)\u4f5c\u4e3a\u4e00\u4e2a\u5b8c\u5168\u6b63\u786e\u7684\u5904\u7406\u5668\uff0c\u5e76\u5c06\u8fd9\u4e2a\u6a21\u62df\u5668\u6784\u5efa\u6210\u4e00\u4e2a\u52a8\u6001\u94fe\u63a5\u5e93\u52a0\u8f7d\u5230\u8f6f\u4ef6\u73af\u5883\u4e2d\u3002</p> <p>\u6b64\u65f6\u8f6f\u4ef6\u5c42\u9762\u5c31\u6709\u4e86\u5904\u7406\u5668\u548c\u6a21\u62df\u5668\uff0c\u4e24\u8005\u5c31\u53ef\u4ee5\u8fdb\u884cDifftest\u5bf9\u6bd4\u4e86\uff0c\u6d4b\u8bd5\u6846\u67b6\u7684\u4e3b\u4f53\u88f8\u673a\u5df2\u7ecf\u5b8c\u6210\u4e86\uff0c\u4e0d\u8fc7\u6b64\u65f6\u6d4b\u8bd5\u6846\u67b6\u8fd8\u6bd4\u8f83\u7b80\u964b\uff0c\u4e0d\u80fd\u591f\u52a0\u8f7d\u548c\u8fd0\u884c\u7a0b\u5e8f\u3002</p> <p>\u7136\u540e\u6d4b\u8bd5\u6846\u67b6\u4f7f\u7528\u4e86\u4e00\u4e2a\u53eb\u505a<code>AbstractMachine</code>\u7684\u88f8\u673a\u8fd0\u884c\u65f6\u73af\u5883\uff0c\u7b80\u79f0AM\uff0c\u5176\u53ef\u4ee5\u5c06\u5404\u79cd\u5404\u6837\u7684\u7a0b\u5e8f\u52a0\u8f7d\u5230\u6d4b\u8bd5\u6846\u67b6\u4e2d\u8fd0\u884c\u3002</p>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#2","title":"2. \u6d4b\u8bd5\u6846\u67b6\u5f00\u53d1\u7ecf\u9a8c\u548c\u5efa\u8bae","text":"<ol> <li>\u7531\u4e8e\u7b2c\u4e00\u4e2a\u7248\u672c\u7684\u6d4b\u8bd5\u6846\u67b6\u5f00\u53d1\u8f83\u4e3a\u7d27\u6025\uff0c\u5e76\u4e14\u7ef4\u62a4\u4e86\u591a\u4e2a\u72ec\u7acb\u7684\u4ed3\u5e93\uff0c\u5bfc\u81f4\u5728\u5f00\u53d1\u548c\u4fee\u6539\u7684\u65f6\u5019\u9700\u8981\u8fdb\u884c\u5927\u91cf\u91cd\u590d\u7684\u4ee3\u7801\u4fee\u6539\u3002\u975e\u5e38\u8017\u8d39\u5f00\u53d1\u8005\u7684\u7cbe\u529b\u3002\u540e\u7eed\u5f00\u53d1\u5efa\u8bae\u6309\u7167\u5de5\u7a0b\u9879\u76ee\u5f00\u53d1\uff0c\u5f00\u53d1\u5b8c\u6210\u4e4b\u540e\u5728\u518d\u589e\u52a0\u4e00\u4e9b\u7528\u6237\u53cb\u597d\u7684\u5185\u5bb9\uff0c\u65b9\u4fbf\u7528\u6237\u4f7f\u7528\u3002</li> <li>\u5efa\u8bae\u4f7f\u7528\u7f51\u9875\u6587\u6863\u8bb0\u5f55\u4e00\u4e9b\u6280\u672f\u70b9\u7684\u7ecf\u9a8c\u548c\u4e00\u4e9b\u5de5\u5177\uff0c\u5f62\u6210\u6280\u672f\u79ef\u7d2f\u3002</li> </ol> <p>\u6587\u6863\u5de5\u5177\u6709<code>vuepress</code>, <code>vitepress</code>, <code>material for mkdocs(\u63a8\u8350\u8fd9\u4e2a)</code>, <code>docsify</code></p>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#_5","title":"\u4e09\u3001\u5176\u4ed6\u6280\u672f\u63a2\u7d22","text":""},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#1_1","title":"1. \u67b6\u6784\u63a2\u7d22","text":"<p>\u6d4b\u8bd5\u6846\u67b6\u53ef\u4ee5\u5c06Difftest\u548c\u6a21\u62df\u5668\u548c\u5904\u7406\u5668\u4e09\u4e2a\u5185\u5bb9\u89e3\u8026\uff0c\u5206\u522b\u72ec\u7acb\u5f00\u53d1\u3002\u7c7b\u4f3c\u4e8e\u9999\u5c71\u7684\u6a21\u5f0f\u4e86emm\u3002</p>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#2_1","title":"2. \u6a21\u62df\u5668\u63a2\u7d22","text":"<p>\u6a21\u62df\u5668\u4e0d\u518d\u4f7f\u7528NEMU\uff0c\u800c\u662f\u4f7f\u7528Spike\u6216\u8005QEMU\u6216\u8005CEMU\u3002</p> <p>CEMU\u662f\u4e00\u4e2a\u7b80\u5355\u7684\u5168\u7cfb\u7edf\u6a21\u62df\u5668\u548cSOC\u6a21\u62df\u5668\uff0c\u4ee3\u7801\u91cf\u8f83\u5c11\uff0c\u4fee\u6539\u8d77\u6765\u4e5f\u6bd4\u8f83\u7b80\u5355\u3002</p> <p>SOC-Simulator\u662f\u4e00\u4e2a\u7b80\u5355\u6613\u7528\u7684\u8f6f\u4ef6\u5b9a\u4e49AXI Slave\u8bbe\u5907\u6846\u67b6\u3002</p>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#3-commit","title":"3. commit\u673a\u5236\u7684\u6539\u8fdb","text":"<p>\u76ee\u524d\u6d4b\u8bd5\u6846\u67b6\u4f7f\u7528\u6307\u4ee4\u63d0\u4ea4\u601d\u60f3\u6765\u63a7\u5236Difftest\u7684 \u8fc7\u7a0b\uff0c\u4e0d\u8fc7\u8be5commit\u673a\u5236\u53ef\u4ee5\u505a\u7684\u66f4\u52a0\u7b80\u5355\u548c\u5b8c\u5584\uff0c\u8fd9\u4e2a\u662f\u4e00\u4e2a\u53ef\u4ee5\u6539\u8fdb\u7684\u65b9\u5411\u3002</p> <p>\u9999\u5c71\u7684commit\u673a\u5236\u548c\u9f99\u82af\u7684chiplab\u673a\u5236\u90fd\u6bd4\u5f53\u524d\u6d4b\u8bd5\u6846\u67b6\u7684commit\u673a\u5236\u7b80\u5355\u3002</p>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#4-spike","title":"4. spike\u7684\u63a2\u7d22","text":"<ol> <li> <p>\u5f00\u53d1\u56e2\u961f\u5bf9spike\u505a\u51fa\u4e00\u5b9a\u7684\u63a2\u7d22\uff0c\u76ee\u524d\u53ef\u4ee5\u6784\u5efaspike\u7684\u52a8\u6001\u94fe\u63a5\u5e93\u3002\u8be6\u60c5\u89c1spike\u4ed3\u5e93\uff0c\u8be5spike\u4ed3\u5e93\u662f\u7531\u4e00\u751f\u4e00\u82af\u7684\u9648\u7490\u5f00\u53d1\u5b8c\u6210\uff0c\u5f00\u53d1\u56e2\u961f\u5c06\u5176\u72ec\u7acb\u62bd\u53d6\u51fa\u6765\u4e86\u3002\u8be5\u4ed3\u5e93\u53ef\u4ee5\u72ec\u7acb\u7684\u6784\u5efa\u4e00\u4e2a32\u4f4d\u7684/64\u4f4d\u7684spike\u52a8\u6001\u94fe\u63a5\u5e93\u3002\u5bf9\u4e8e\u7b80\u5355\u7a0b\u5e8f\uff0cDifftest\u53ea\u9700\u8981\u6bd4\u5bf932\u4e2a\u901a\u7528\u5bc4\u5b58\u5668\u5373\u53ef\uff0c\u968f\u7740\u5904\u7406\u5668\u53d8\u5f97\u66f4\u52a0\u590d\u6742\uff0c\u9700\u8981\u5bf9\u6bd4CSR\u5bc4\u5b58\u5668\uff0c\u53ef\u4ee5\u901a\u8fc7<code>state</code>\u53d8\u91cf\u83b7\u53d6CSR\u53d8\u91cf\u3002</p> </li> <li> <p>\u4fee\u6539<code>spike</code>\u6e90\u4ee3\u7801\u7684\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528<code>ccache</code>\u52a0\u901f\u7f16\u8bd1\uff0c\u53ef\u4ee5\u5c06\u7f16\u8bd1\u65f6\u95f4\u4ece\u51e0\u5206\u949f\u964d\u4f4e\u81f330s\u5de6\u53f3\u3002\u6ce8\u610f<code>ccache</code>\u9ed8\u8ba4\u4e0d\u94fe\u63a5<code>riscv64-unknown-elf-</code>\uff0c\u9700\u8981\u5bf9ccache\u505a\u51fa\u4e00\u5b9a\u7684\u4fee\u6539,\u53ef\u4ee5\u8be2\u95eeAI\u3002</p> </li> <li> <p>\u4f7f\u7528spike\u6a21\u62df\u5668\u8fd0\u884c\u7a0b\u5e8f\u7684\u4e00\u4e2a\u7b80\u5355Makefile\u6846\u67b6\u2014\u2014use-spike</p> </li> </ol>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#5-elfbin","title":"5. elf\u7a0b\u5e8f\u548cbin\u6587\u4ef6\u7684\u63a2\u7d22","text":"<p>\u76ee\u524d\u6d4b\u8bd5\u6846\u67b6\u52a0\u8f7d\u7684\u7a0b\u5e8f\u662felf\u683c\u5f0f\uff0c\u4e5f\u5c31\u662f\u8bf4\u6d4b\u8bd5\u6846\u67b6\u80fd\u591f\u76f4\u63a5\u8fd0\u884c\u7a0b\u5e8f\u3002\u4e0d\u8fc7\u5982\u679c\u53ea\u662f\u4e3a\u4e86\u5b9e\u73b0Difftest\u5bf9\u6bd4\u529f\u80fd\uff0c\u5176\u5b9e\u53ef\u4ee5\u4e0d\u7528\u52a0\u8f7delf\u7a0b\u5e8f\uff0c\u53ef\u4ee5\u4f7f\u7528bin\u6587\u4ef6\u3002\u5e76\u4e14\u5982\u679c\u4f7f\u7528bin\u6587\u4ef6\uff0c\u5c31\u53ef\u4ee5\u53bb\u9664\u6389\u5bf9\u4e8eAM\u7684\u4f9d\u8d56\uff0c\u4e0d\u8fc7\u5e76\u6ca1\u6709\u5c1d\u8bd5\u6210\u529f\u3002</p>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#6-linux","title":"6. \u542f\u52a8Linux\u7684\u63a2\u7d22","text":"<p><code>spike</code>\u542f\u52a8linux\u7684\u8d44\u6599\u8fc7\u5c11\uff0c\u800cqemu\u542f\u52a8linux\u7684\u8d44\u6599\u4f17\u591a\uff0c\u53ef\u4ee5\u5148\u4f7f\u7528<code>qemu</code>\u542f\u52a8<code>linux</code>, \u628a\u6d41\u7a0b\u641e\u719f\u6089\u4e4b\u540e\uff0c\u518d\u6765\u4f7f\u7528<code>spike</code>\u542f\u52a8<code>linux</code>\u3002</p>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#7-riscv","title":"7. riscv\u7f16\u8bd1\u5668\u7684\u63a2\u7d22","text":"<ol> <li>riscv64-linux-gnu-</li> <li>\u9002\u7528\u4e8e riscv64 \u67b6\u6784\u3001\u9762\u5411 linux-gnu \u5e73\u53f0\uff08\u4f7f\u7528 glibc \u6807\u51c6\u5e93\uff09\u7684\u5de5\u5177\u94fe\u3002</li> <li>\u53ef\u901a\u8fc7\u5305\u7ba1\u7406\u5de5\u5177\uff08\u5982 Ubuntu \u7684 apt\uff09\u5b89\u88c5\u3002\u53d7\u9650\u4e8e\u53d1\u884c\u7248\u8f6f\u4ef6\u6e90\u9650\u5236\uff0c\u5176\u7f16\u8bd1\u5668\u7248\u672c\u53ef\u80fd\u8f83\u8001\u3002</li> <li>riscv64-unknown-linux-gnu-</li> <li>\u9002\u7528\u4e8e riscv64 \u67b6\u6784\u3001\u9762\u5411 linux-gnu \u5e73\u53f0\uff08\u4f7f\u7528 glibc \u6807\u51c6\u5e93\uff09\u7684\u5de5\u5177\u94fe\uff0c\u53ef\u4ee5\u4e0e <code>riscv64-linux-gnu-</code> \u76f8\u4e92\u66ff\u6362\u3002</li> <li>\u53ef\u4ece riscv-collab/riscv-gnu-toolchain \u6784\u5efa\u3002</li> <li>\u76f4\u63a5\u4e0b\u8f7d\u8be5\u7f16\u8bd1\u5668\u5e76\u7f16\u8bd1\u9884\u8ba1\u8017\u65f64h\uff0c\u53ef\u4ee5\u901a\u8fc7<code>github/release</code>\u76f4\u63a5\u4e0b\u8f7d\u7f16\u8bd1\u597d\u7684\u6e90\u7801\uff0c\u5f00\u7bb1\u5373\u7528\u3002</li> <li>riscv64-unknown-elf-</li> <li>\u9002\u7528\u4e8e riscv64 \u67b6\u6784\u3001\u9762\u5411\u5d4c\u5165\u5f0f/\u88f8\u673a\u5e73\u53f0\uff08\u4f7f\u7528 newlib \u6807\u51c6\u5e93\uff09\u7684\u5de5\u5177\u94fe\u3002</li> <li>\u53ef\u4ece riscv-collab/riscv-gnu-toolchain \u6784\u5efa\u3002</li> <li>\u4e0d\u63a8\u8350\u901a\u8fc7\u5305\u7ba1\u7406\u5de5\u5177\u5b89\u88c5\u6b64\u7f16\u8bd1\u94fe\u3002\u53d1\u884c\u7248\u8f6f\u4ef6\u6e90\u4e2d\u7684\u6b64\u5de5\u5177\u94fe\u5e38\u5e38\u7f3a\u5c11\u5173\u952e\u7684 newlib \u6807\u51c6\u5e93\u3002</li> <li>\u76f4\u63a5\u4e0b\u8f7d\u8be5\u7f16\u8bd1\u5668\u5e76\u7f16\u8bd1\u9884\u8ba1\u8017\u65f64h\uff0c\u53ef\u4ee5\u901a\u8fc7<code>github/release</code>\u76f4\u63a5\u4e0b\u8f7d\u7f16\u8bd1\u597d\u7684\u6e90\u7801\uff0c\u5f00\u7bb1\u5373\u7528\u3002</li> </ol>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#8-lightsss","title":"8. LightSSS","text":"<p>\u9999\u5c71LightSSS\u94fe\u63a5\u5728\u5904\u7406\u5668\u8c03\u8bd5\u8fc7\u7a0b\u4e2d\uff0c\u5e76\u4e0d\u9700\u8981\u5b8c\u6574\u8fc7\u7a0b\u7684\u6ce2\u5f62\uff0c\u53ea\u9700\u8981\u5728\u4eff\u771f\u51fa\u9519\u7684\u65f6\u5019\u628a\u524d\u9762\u4e00\u6bb5\u65f6\u95f4\u5185\u7684\u6ce2\u5f62\u4fdd\u5b58\u5373\u53ef\u3002<code>Verilator</code>\u7b49\u4eff\u771f\u5668\u63d0\u4f9b\u4e86\u6301\u4e45\u5316\u4fdd\u5b58\u7535\u8def\u72b6\u6001\u7684<code>snapshot</code>\u529f\u80fd\uff0c\u4eff\u771f\u51fa\u9519\u65f6\u53ef\u4ee5\u8c03\u7528\u8fd9\u4e2a\u529f\u80fd\u751f\u6210\u76f8\u5e94\u7684\u72b6\u6001\u6587\u4ef6\uff0c\u590d\u73b0\u9519\u8bef\u7684\u65f6\u5019\u53ef\u4ee5\u7528\u8fd9\u4e2a\u6587\u4ef6\u4ece\u7279\u5b9a\u7535\u8def\u72b6\u6001\u5f00\u59cb\u8dd1\u4eff\u771f\u3002\u4f46\u8fd9\u4e2a\u529f\u80fd\u7684\u5c40\u9650\u6027\u6709\u4ee5\u4e0b\u51e0\u70b9\uff1a</p> <ul> <li>\u53ea\u80fd\u4fdd\u5b58RTL\u7535\u8def\u7684\u72b6\u6001\uff0c\u5176\u4ed6\u4eff\u771f\u7684\u90e8\u5206\u6bd4\u5982\u53c2\u8003\u6a21\u578b\u3001DRAMSim3\u7b49\u7684\u72b6\u6001\u4e0d\u80fd\u88ab\u4fdd\u5b58</li> <li>\u800c\u4e14\u5f53\u7535\u8def\u89c4\u6a21\u6bd4\u8f83\u5927\u7684\u65f6\u5019\uff0c\u4fdd\u5b58\u7535\u8def\u72b6\u6001\u7684\u5b58\u50a8\u5f00\u9500\u6bd4\u8f83\u5927</li> </ul> <p>\u4e3a\u6b64\u6211\u4eec\u5f00\u53d1\u4e86\u8f7b\u91cf\u7ea7\u7684\u4eff\u771f\u5feb\u7167\u5de5\u5177<code>lightSSS</code>\uff0c\u5b83\u53ef\u4ee5\u5728\u4eff\u771f\u8fdb\u7a0b\u51fa\u9519\u65f6\u81ea\u52a8\u4fdd\u5b58\u51fa\u9519\u70b9\u9644\u8fd1\u7684\u6ce2\u5f62\u548cdebug\u4fe1\u606f\u800c\u4e0d\u9700\u8981\u7ecf\u8fc7\u7535\u8def\u72b6\u6001\u6587\u4ef6\u8fd9\u4e2a\u4e2d\u95f4\u5c42\u3002</p>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#9","title":"9. \u81ea\u52a8\u5316\u6d4b\u8bd5","text":"<p>\u53ef\u4ee5\u4f7f\u7528github\u7684ci\u811a\u672c\u8fdb\u884c\u81ea\u52a8\u5316\u6d4b\u8bd5</p>"},{"location":"%E6%8A%80%E6%9C%AF%E6%A2%B3%E7%90%86/#_6","title":"\u56db\u3001\u5176\u4ed6\u8d44\u6599","text":"<ol> <li> <p>\u56fd\u5916\u7684\u5904\u7406\u5668</p> </li> <li> <p>https://github.com/openhwgroup</p> </li> <li> <p>\u6d59\u6c5f\u5927\u5b66\u5173\u4e8e<code>RISCV</code>\u5904\u7406\u5668\u7684\u8bfe\u7a0b\u2014\u2014\u8ba1\u7b97\u673a\u7cfb\u7edfI,II,III\uff0c\u8be5\u8bfe\u7a0b\u76f8\u5173\u4ed3\u5e93\u5728\u4e0b\u9762\u4e24\u4e2a\u94fe\u63a5\u3002</p> </li> <li> <p>https://gitee.com/crix1021</p> </li> <li>ZJU Computer System Course: \u6d59\u6c5f\u5927\u5b66\u8ba1\u7b97\u673a\u7cfb\u7edf\u8d2f\u901a\u8bfe\u7a0b\uff08RISC-V\u67b6\u6784\uff09\u5b9e\u9a8c\u4ed3\u5e93\u516c\u5f00\u7248</li> <li> <p>https://github.com/sycuricon</p> </li> <li> <p>\u4e2d\u79d1\u5927\u5173\u4e8e\u6570\u5b57\u7535\u8def\u548c\u8ba1\u7ec4\u548c\u8ba1\u7b97\u673a\u4f53\u7cfb\u7ed3\u6784\u7684\u8bfe\u7a0b\u5b9e\u9a8c\u3002</p> </li> <li> <p>https://soc.ustc.edu.cn/CECS/</p> </li> <li> <p>https://soc.ustc.edu.cn/</p> </li> <li> <p>\u91cd\u5e86\u5927\u5b66RISCV\u5904\u7406\u5668\u8bfe\u7a0b\uff0cMIPS\u542f\u52a8Linux\uff08\u7531\u9648\u6cf1\u5b87\u6784\u5efa\uff0c\u91cd\u5e86\u5927\u5b66\u535a\u58eb\u751f\uff0c\u9f99\u82af\u676f\u5f3a\u529b\u9009\u624b\uff0c\u9999\u5c71\u5b9e\u4e60\uff09</p> </li> <li> <p>https://github.com/Maxpicca-Li/CDIM/tree/master</p> </li> <li>https://github.com/cyyself</li> <li> <p>https://co.ccslab.cn/basic/basic_cache/</p> </li> <li> <p>\u5357\u4eac\u5927\u5b66\u8bfe\u7a0b\u2014\u2014\u4e0d\u8003\u8651\u3002</p> </li> <li> <p>https://github.com/NJU-ProjectN</p> </li> <li> <p>\u5176\u4ed6\u8d44\u6599</p> </li> </ol> <p>RISCV\u56fd\u9645\u57fa\u91d1\u4f1a\u548c\u4e00\u751f\u4e00\u82af\u89c6\u9891\u53f7\u548c\u5317\u4eac\u5f00\u6e90\u82af\u7247\u7814\u7a76\u9662\u548c\u4e00\u751f\u4e00\u82af\u9ad8\u7ea7\u4f53\u7cfb\u7ed3\u6784\u7814\u7a76\u5c0f\u7ec4\u2014\u535a\u58eb\u751f\u6bb5\u9707\u4f1f\u91cc\u9762\u6709\u4e00\u4e9b\u5173\u4e8e<code>RISC-V</code>\u7684\u62a5\u544a\u548c\u5206\u4eab\uff0c\u6709\u4e00\u4e9b\u7ecf\u9a8c\u5206\u4eab\uff0c\u53ef\u4f9b\u53c2\u8003\u3002</p> <ol> <li>\u4e00\u751f\u4e00\u82af\u5b66\u5458\uff0c\u5df2\u7ecf\u5728\u4e00\u751f\u4e00\u82af\u768432\u4f4d\u6846\u67b6\u4e0a\u5df2\u542f\u52a8Linux\u3002</li> </ol> <p>https://github.com/CmdBlockZQG</p> <ol> <li>\u4e00\u751f\u4e00\u82af\u5b66\u5458\u548c\u52a9\u6559</li> </ol> <p>\u963f\u5764github\u7684following\u548cfollowers\u57fa\u672c\u90fd\u662f\u4e00\u751f\u4e00\u82af\u7684\u52a9\u6559\u548c\u5b66\u5458\uff0c\u4ed6\u4eec\u5927\u591a\u90fd\u5f00\u53d1\u8fc7\u81ea\u5df1\u7684RISC-V\u5904\u7406\u5668\u548cRISC-V\u6a21\u62df\u5668\uff0c\u53ef\u4ee5\u76f4\u63a5\u590d\u7528\u9879\u76ee\u8fdb\u884c\u53c2\u8003\u3002</p>"},{"location":"computer/cpu/modelsim/","title":"modelsim","text":""},{"location":"computer/cpu/modelsim/#modelsim-","title":"modelsim------\u4ee5\u4e0b\u5185\u5bb9\u5f85\u68b3\u7406","text":"<p>modelsim\u521b\u5efa\u65b0\u9879\u76ee\u540e\u4f1a\u5728Project Location\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a$default library name\u7684\u6587\u4ef6\u5939\uff0c\u91cc\u9762\u5c06\u4f1a\u5305\u542b\u4e00\u4e2a_info\u6587\u4ef6</p>"},{"location":"computer/cpu/modelsim/#vscodeverilog-hdl","title":"VSCode\u4e2d\u7684Verilog HDL\u5f00\u53d1\u63d2\u4ef6","text":"\u63d2\u4ef6 \u7279\u70b9 Verilog Hdl Format \u6709\u4e2d\u6587\u6587\u6863\uff0c\u4e0a\u624b\u6bd4\u8f83\u7b80\u5355\u65b9\u4fbf"},{"location":"computer/cpu/instruction-set/riscv-information/","title":"riscv\u76f8\u5173\u8d44\u6599","text":""},{"location":"computer/cpu/instruction-set/riscv-information/#_1","title":"\u4e66\u7c4d","text":"<ol> <li>CPU\u8bbe\u8ba1\u5b9e\u6218</li> <li>\u8ba1\u7b97\u673a\u7ec4\u6210\u4e0e\u8bbe\u8ba1\uff1a\u786c\u4ef6\u8f6f\u4ef6\u63a5\u53e3RISC-V\u7248</li> <li>\u6df1\u5165\u7406\u89e3\u8ba1\u7b97\u673a\u7cfb\u7edf</li> <li>VERILOG HDL \u9ad8\u7b49\u6570\u5b57\u8bbe\u8ba1</li> </ol>"},{"location":"computer/cpu/instruction-set/riscv-information/#riscv","title":"riscv\u5904\u7406\u5668\u6587\u6863","text":"<ol> <li>\u679c\u58f3\u5904\u7406\u5668\u6587\u6863</li> <li>suda-morris\u7684riscv\u535a\u5ba2</li> </ol>"},{"location":"computer/cpu/instruction-set/riscv-information/#github","title":"github\u4e0a\u7684\u5904\u7406\u5668\u9879\u76ee","text":"<ol> <li>\u70db\u9f99\u5904\u7406\u5668[verilog]</li> <li>tiny-riscv[verilog]</li> <li>riscv-mcu[verilog]</li> </ol>"},{"location":"computer/cpu/instruction-set/riscv-information/#riscv_1","title":"\u516c\u53f8\u5f00\u6e90\u7684riscv\u5904\u7406\u5668","text":""},{"location":"computer/cpu/instruction-set/riscv-information/#_2","title":"\u5176\u4ed6\u6742\u9879\uff0c\u5f85\u6574\u7406","text":"<ol> <li>\u4e00\u4e2a\u7b80\u6d01\u7684riscv\u6307\u4ee4\u96c6\u6587\u6863\u2014\u2014\u4e0d\u4fdd\u8bc1\u5b8c\u5168\u51c6\u786e</li> <li>riscv\u5728\u7ebf\u8bd1\u7801\u5668</li> <li>vcd\u6587\u4ef6\u7684\u547d\u4ee4\u884c\u663e\u793a\u5de5\u5177</li> <li>\u4e00\u4e2ariscv\u4e94\u7ea7\u6d41\u6c34\u7ebf\u9879\u76ee</li> </ol>"},{"location":"computer/cpu/instruction-set/riscv/","title":"Riscv","text":"<p>title: riscv32IM\u6307\u4ee4\u4ecb\u7ecd editLink: true layout: doc</p>"},{"location":"computer/cpu/instruction-set/riscv/#riscv","title":"riscv\u6307\u4ee4\u4ecb\u7ecd","text":""},{"location":"computer/cpu/instruction-set/y86/","title":"riscv32IM\u6307\u4ee4\u4ecb\u7ecd","text":""},{"location":"computer/cpu/instruction-set/y86/#y86","title":"y86\u6a21\u62df\u5668","text":"<p>y86-64\u6a21\u62df\u5668</p> <p>\u4f7f\u7528\u65b9\u6cd5\u89c1CSAPP\u7684Chapter 4: Processor Architecture</p>"},{"location":"computer/git/git/","title":"git","text":""},{"location":"computer/git/git/#git","title":"git \u63d0\u4ea4","text":"<p>\u4ee5\u4e0b\u6587\u5b57\u6765\u6e90\u4e8e\u901a\u4e49\u5343\u95ee</p> <ul> <li> <p>feat (Feature): \u7528\u4e8e\u8868\u793a\u65b0\u529f\u80fd\u7684\u5f00\u53d1\u3002\u5f53\u63d0\u4ea4\u5305\u542b\u65b0\u7684\u7528\u6237\u7279\u6027\u6216\u8005\u589e\u5f3a\u73b0\u6709\u529f\u80fd\u65f6\u4f7f\u7528\u6b64\u6807\u7b7e\u3002\u4f8b\u5982\uff1a<code>feat: \u6dfb\u52a0\u7528\u6237\u641c\u7d22\u529f\u80fd</code></p> </li> <li> <p>refactor: \u5f53\u4ee3\u7801\u91cd\u6784\u5e76\u4e0d\u6539\u53d8\u5176\u5916\u90e8\u884c\u4e3a\u65f6\u4f7f\u7528\u6b64\u6807\u7b7e\u3002\u91cd\u6784\u53ef\u80fd\u5305\u62ec\u6539\u8fdb\u4ee3\u7801\u7ed3\u6784\u3001\u63d0\u9ad8\u6027\u80fd\u6216\u8005\u7b80\u5316\u590d\u6742\u5ea6\u3002\u4f8b\u5982\uff1a<code>refactor: \u91cd\u6784\u767b\u5f55\u6a21\u5757\u4ee5\u51cf\u5c11\u91cd\u590d\u4ee3\u7801</code></p> </li> <li> <p>docs: \u4ec5\u6d89\u53ca\u6587\u6863\u66f4\u6539\uff08\u5982README\u6587\u4ef6\u3001API\u6587\u6863\u7b49\uff09\u800c\u4e0d\u5f71\u54cd\u4ee3\u7801\u903b\u8f91\u65f6\u4f7f\u7528\u6b64\u6807\u7b7e\u3002\u4f8b\u5982\uff1a<code>docs: \u66f4\u65b0\u5b89\u88c5\u6307\u5357</code></p> </li> <li> <p>style: \u4e0d\u5f71\u54cd\u4ee3\u7801\u542b\u4e49\u7684\u6539\u52a8\uff0c\u6bd4\u5982\u7a7a\u683c\u3001\u683c\u5f0f\u5316\u3001\u5206\u53f7\u7b49\u3002\u4f8b\u5982\uff1a<code>style: \u8c03\u6574\u7f29\u8fdb\u98ce\u683c</code></p> </li> <li> <p>chore: \u8fdb\u884c\u6784\u5efa\u8fc7\u7a0b\u6216\u8f85\u52a9\u5de5\u5177\u7684\u66f4\u65b0\uff0c\u5982\u6253\u5305\u5de5\u5177\u914d\u7f6e\u3001\u4f9d\u8d56\u7248\u672c\u5347\u7ea7\u7b49\u3002\u4f8b\u5982\uff1a<code>chore: \u5347\u7ea7\u5230Webpack 5</code></p> </li> <li> <p>perf (Performance): \u4e13\u95e8\u9488\u5bf9\u6027\u80fd\u4f18\u5316\u7684\u63d0\u4ea4\u3002\u4f8b\u5982\uff1a<code>perf: \u51cf\u5c11\u4e3b\u9875\u9762\u52a0\u8f7d\u65f6\u95f4</code></p> </li> <li> <p>test: \u589e\u52a0\u7f3a\u5c11\u7684\u6d4b\u8bd5\u3001\u4fee\u6b63\u73b0\u6709\u7684\u6d4b\u8bd5\u3002\u4f8b\u5982\uff1a<code>test: \u6dfb\u52a0\u5355\u5143\u6d4b\u8bd5\u8986\u76d6\u65b0\u529f\u80fd</code></p> </li> <li> <p>ci (Continuous Integration): \u4fee\u6539\u6301\u7eed\u96c6\u6210\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u6216\u811a\u672c\u3002\u4f8b\u5982\uff1a<code>ci: \u914d\u7f6eTravis CI\u73af\u5883\u53d8\u91cf</code></p> </li> <li> <p>build: \u5f71\u54cd\u6784\u5efa\u7cfb\u7edf\u6216\u5916\u90e8\u4f9d\u8d56\u5173\u7cfb\u7684\u66f4\u6539\u3002\u4f8b\u5982\uff1a<code>build: \u6dfb\u52a0Babel\u7f16\u8bd1\u652f\u6301</code></p> </li> <li> <p>revert: \u64a4\u9500\u4e4b\u524d\u7684\u63d0\u4ea4\u3002\u901a\u5e38\u4f1a\u76f4\u63a5\u8ddf\u4e0a\u88ab\u64a4\u9500\u63d0\u4ea4\u7684\u54c8\u5e0c\u503c\u6216\u6807\u9898\u3002\u4f8b\u5982\uff1a<code>revert: \"feat: \u6dfb\u52a0\u7528\u6237\u641c\u7d22\u529f\u80fd\"</code></p> </li> </ul>"},{"location":"riscv-isa-doc/rv64/rv64i/","title":"rv64m","text":""},{"location":"riscv-isa-doc/rv64/rv64i/#u_type","title":"U_TYPE","text":"\u7528\u6237\u81ea\u5b9a\u4e49\u7c7b\u578b func7 func3 opcode \u6307\u4ee4\u6548\u679c lui u_lui \u65e0 \u65e0 0110111 auipc u_auipc \u65e0 \u65e0 0010111"},{"location":"riscv-isa-doc/rv64/rv64i/#r_type","title":"R_TYPE","text":"\u7528\u6237\u81ea\u5b9a\u4e49\u7c7b\u578b func7 func3 opcode \u6307\u4ee4\u6548\u679c add r_alu_reg 0000000 000 0110011 sub r_alu_reg 0100000 000 0110011 sll r_alu_reg 0000000 001 0110011 slt r_alu_reg 0000000 010 0110011 sltu r_alu_reg 0000000 011 0110011 xor r_alu_reg 0000000 100 0110011 srl r_alu_reg 0000000 101 0110011 sra r_alu_reg 0100000 101 0110011 or r_alu_reg 0000000 110 0110011 and r_alu_reg 0000000 111 0110011 addw r_alu_reg_w 0000000 000 0111011 subw r_alu_reg_w 0100000 000 0111011 sllw r_alu_reg_w 0000000 001 0111011 srlw r_alu_reg_w 0000000 101 0111011 sraw r_alu_reg_w 0100000 101 0111011"},{"location":"riscv-isa-doc/rv64/rv64i/#j_type","title":"J_TYPE","text":"\u7528\u6237\u81ea\u5b9a\u4e49\u7c7b\u578b func7 func3 opcode \u6307\u4ee4\u6548\u679c jal j_jal \u65e0 \u65e0 1101111"},{"location":"riscv-isa-doc/rv64/rv64i/#s_type","title":"S_type","text":"\u7528\u6237\u81ea\u5b9a\u4e49\u7c7b\u578b func7 func3 opcode \u6307\u4ee4\u6548\u679c sb s_store \u65e0 000 0100011 sh s_store \u65e0 001 0100011 sw s_store \u65e0 010 0100011 sd s_store \u65e0 011 0100011"},{"location":"riscv-isa-doc/rv64/rv64i/#b_type","title":"B_type","text":"\u7528\u6237\u81ea\u5b9a\u4e49\u7c7b\u578b func7 func3 opcode \u6307\u4ee4\u6548\u679c beq b_branch \u65e0 000 1100011 bne b_branch \u65e0 001 1100011 blt b_branch \u65e0 100 1100011 bge b_branch \u65e0 101 1100011 bltu b_branch \u65e0 110 1100011 bgeu b_branch \u65e0 111 1100011"},{"location":"riscv-isa-doc/rv64/rv64i/#i_type","title":"I_type","text":"\u7528\u6237\u81ea\u5b9a\u4e49\u7c7b\u578b func7 func3 opcode \u6307\u4ee4\u6548\u679c jalr i_jalr \u65e0 000 1100111 lb i_load \u65e0 000 0000011 lh i_load \u65e0 001 0000011 lw i_load \u65e0 010 0000011 ld i_load \u65e0 011 0000011 lbu i_load \u65e0 100 0000011 lhu i_load \u65e0 101 0000011 lwu i_load \u65e0 110 0000011 addi i_alu_imm \u65e0 000 0010011 slti i_alu_imm \u65e0 010 0010011 sltiu i_alu_imm \u65e0 011 0010011 xori i_alu_imm \u65e0 100 0010011 ori i_alu_imm \u65e0 110 0010011 andi i_alu_imm \u65e0 111 0010011 slli i_alu_imm 000000 001 0010011 srli i_alu_imm 000000 101 0010011 srai i_alu_imm 010000 101 0010011 addiw i_alu_imm_w \u65e0 000 0011011 slliw i_alu_imm_w 0000000 001 0011011 srliw i_alu_imm_w 0000000 101 0011011 sraiw i_alu_imm_w 0100000 101 0011011 csrrw i_system \u65e0 001 1110011 csrrs i_system \u65e0 010 1110011 csrrc i_system \u65e0 011 1110011 csrrwi i_system \u65e0 101 1110011 csrrsi i_system \u65e0 110 1110011 csrrci i_system \u65e0 111 1110011 ecall i_system 000 1110011 \u8fd9\u4e2a\u6307\u4ee4\u4fe1\u606f\u5199\u7684\u4e0d\u5168 ebreak i_system 000 1110011 \u8fd9\u4e2a\u6307\u4ee4\u4fe1\u606f\u5199\u7684\u4e0d\u5168 uret i_system 000 1110011 \u8fd9\u4e2a\u6307\u4ee4\u4fe1\u606f\u5199\u7684\u4e0d\u5168 sret i_system 000 1110011 \u8fd9\u4e2a\u6307\u4ee4\u4fe1\u606f\u5199\u7684\u4e0d\u5168 mret i_system 000 1110011 \u8fd9\u4e2a\u6307\u4ee4\u4fe1\u606f\u5199\u7684\u4e0d\u5168 wfi i_system 000 1110011 \u8fd9\u4e2a\u6307\u4ee4\u4fe1\u606f\u5199\u7684\u4e0d\u5168 sfence.vma i_system 000 1110011 \u8fd9\u4e2a\u6307\u4ee4\u4fe1\u606f\u5199\u7684\u4e0d\u5168"},{"location":"riscv-isa-doc/rv64/rv64i/#_1","title":"\u6682\u672a\u5206\u7c7b\u522b\u7684\u6307\u4ee4","text":"\u7528\u6237\u81ea\u5b9a\u4e49\u7c7b\u578b func7 func3 opcode \u6307\u4ee4\u6548\u679c fence 000 0001111 \u8fd9\u4e2a\u6307\u4ee4\u4fe1\u606f\u5199\u7684\u4e0d\u5168 fence.i 001 0001111 \u8fd9\u4e2a\u6307\u4ee4\u4fe1\u606f\u5199\u7684\u4e0d\u5168"},{"location":"riscv-isa-doc/rv64/rv64m/","title":"rv64m","text":""},{"location":"riscv-isa-doc/rv64/rv64m/#r_type","title":"R_TYPE","text":"\u7528\u6237\u81ea\u5b9a\u4e49\u7c7b\u578b func7 func3 opcode \u6307\u4ee4\u6548\u679c mul r_alu_reg 0000001 000 0110011 mulh r_alu_reg 0000001 001 0110011 mulhsu r_alu_reg 0000001 010 0110011 mulhu r_alu_reg 0000001 011 0110011 div r_alu_reg 0000001 100 0110011 divu r_alu_reg 0000001 101 0110011 rem r_alu_reg 0000001 110 0110011 remu r_alu_reg 0000001 111 0110011 mulw r_alu_reg_w 0000001 000 0111011 divw r_alu_reg_w 0000001 100 0111011 divuw r_alu_reg_w 0000001 101 0111011 remw r_alu_reg_w 0000001 110 0111011 remuw r_alu_reg_w 0000001 111 0111011"}]}